(this.webpackJsonp=this.webpackJsonp||[]).push([[17],{1026:function(e,t,n){e.exports={itemTable:"styles-module__itemTable___GK4H_"}},1092:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(126);t.a=Object(o.a)(a.a.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz")},1117:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return m}));var r=n(0),a=n.n(r),o=n(43),i=n.n(o),s=n(25),l=n(956),c=n(348);function u(){return(u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=d(Object(r.useState)(null),2),n=t[0],o=t[1],p=Object(c.a)({lists:e.initialMyLists,listItems:e.initialMyListItems},e.context,"TRAIL_PAGE"),m=p.listMethods,f=p.renderModal;return Object(r.useEffect)((function(){o(Object(s.g)()&&window.parent&&window.parent.messagingTunnel?window.parent.messagingTunnel("explore_messagingChannel"):i.a.channel("explore_messagingChannel"))}),[]),Object(r.useEffect)((function(){n&&n.subscribe("lists.changed",(function(e){var t=e.lists,n=e.listItems;return m.setListsAndListItems({lists:t,listItems:n})}))}),[n]),a.a.createElement(a.a.Fragment,null,f(),a.a.createElement(l.a,u({listMethods:m,messagingChannel:n},e)))}},121:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(773),l=n.n(s),c=n(128),u=n.n(c),d=function(e){var t=e.value,n=e.disabled,r=e.className;return a.a.createElement("input",{type:"submit","data-testid":"formButton-submit",disabled:n,className:"".concat(u.a.submit," ").concat(l.a.submit," ").concat(r),value:t})};d.propTypes={value:i.a.string.isRequired,disabled:i.a.bool,className:i.a.string},d.defaultProps={disabled:!1,className:""};var p=d},128:function(e,t,n){e.exports={button:"styles-module__button___3dGd8",submit:"styles-module__submit___3T4N6",outline:"styles-module__outline___3YN2z",remove:"styles-module__remove___3i1CB",text:"styles-module__text___18M9-",appleLogin:"styles-module__appleLogin___30Ook",facebookLogin:"styles-module__facebookLogin___1k9H2",googleLogin:"styles-module__googleLogin___SH_Tt",contents:"styles-module__contents___jajXZ",applePayIcon:"styles-module__applePayIcon___Ajzlb",payPalIcon:"styles-module__payPalIcon___2vVqj",amazonPayIcon:"styles-module__amazonPayIcon___2dsHy",amazonPay:"styles-module__amazonPay___3jaDI",appleCheckout:"styles-module__appleCheckout___2ZHcQ",payPalCheckout:"styles-module__payPalCheckout___3oRlc",amazonCheckout:"styles-module__amazonCheckout___1fi4j"}},137:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(128),l=n.n(s),c=function(e){var t=e.text,n=e.handler,r=e.variant,o=e.classes;return a.a.createElement("div",{className:"".concat(l.a[r]," ").concat(o),onKeyPress:function(e){"Enter"===e.key&&n()},onClick:n,tabIndex:"0",role:"button"},t)};c.defaultProps={text:"submit",handler:function(){},variant:"submit",classes:""},c.propTypes={text:i.a.string,handler:i.a.func,variant:i.a.string,classes:i.a.string};var u=c},150:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return p})),n.d(t,"d",(function(){return g}));var r=n(0),a=n.n(r),o=n(494);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d=a.a.createContext({}),p="LOG_IN_USER",m=function(e,t){switch(t.type){case"UPDATE_WINDOW_WIDTH":return c(c({},e),{},{windowWidth:t.payload});case p:return c(c({},e),{},{context:c(c({},e.context),{},{currentUser:t.payload,adminUser:t.payload.admin,proUser:t.payload.pro})});default:return e}},f=function(e){var t=e.context,n=e.children,s=i(Object(r.useReducer)(m,{context:t,windowWidth:null}),2),l=s[0],c=s[1],u=Object(r.useRef)({current:null});return Object(o.a)((function(e){c({type:"UPDATE_WINDOW_WIDTH",payload:e})})),a.a.createElement(d.Provider,{value:{globalState:l,dispatchGlobalState:c,modalRef:u.current}},a.a.createElement("div",{id:"modalPortal",ref:u}),n)};function g(){var e=Object(r.useContext)(d);if(void 0===e)throw new Error("The page context is undefined. Are you using usePageContext within PageContext?");return e.globalState.context}},155:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(0),a=n.n(r),o=n(1),i=n(523),s=n.n(i),l=n(322),c=n(2),u=function(e){var t=e.icon,n=e.large,o=e.onClick,i=e.title,u=e.className,d=e.rotation,p=e.print,m=Object(r.useMemo)((function(){return{backgroundImage:"url(".concat(t),transition:"transform .4s ease-in-out",transform:"rotate(".concat(d,"deg)")}}),[d]);return a.a.createElement("button",{type:"button",className:"".concat(n?s.a.largeButton:s.a.smallButton," ").concat(u),"aria-label":i,onClick:o,title:i,style:m},p&&a.a.createElement("img",{alt:c.b.strings.PRO.ALLTRAILS_PRO,className:s.a.proBadge,src:l.a}))},d=u;u.propTypes={icon:o.string.isRequired,large:o.bool,onClick:o.func.isRequired,title:o.string.isRequired,className:o.string,rotation:o.number},u.defaultProps={large:!1,className:"",rotation:0}},181:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"b",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(15),a=function(e){return Object(r.b)({url:"/api/alltrails/v2/trails/".concat(e,"/photos"),data:{with_location:"Y"},resReducer:function(e){return e.photos}})},o=function(e){return Object(r.b)({url:"/api/alltrails/v2/trails/".concat(e,"/waypoints"),resReducer:function(e){return e.waypoints}})},i=function(e,t){return Object(r.b)({url:"/api/alltrails/trails/".concat(e,"/public_tracks"),data:t,resReducer:function(t){return t.maps.map((function(t){return t.trailId=e,t}))}})},s=function(e){return Object(r.b)({url:"/api/alltrails/trails/".concat(e,"/user_trail_checkins"),resReducer:function(e){return e.user_trail_checkins}})},l=function(e){return Object(r.b)({url:"/api/alltrails/edits/trails/admin/contrib-vrs/",data:{trail_id:e},resReducer:function(e){return e.maps}})},c=function(e,t,n){return Object(r.b)({url:"/api/alltrails/trails/".concat(e,"/nearby_trails"),data:{page:t,per_page:n},resReducer:function(e){return e.trails}})},u=function(e,t){return Object(r.b)({url:"/api/alltrails/trails/".concat(e.ID,"/merge"),data:{merge_trail_id:t.ID}})}},197:function(e,t,n){e.exports={container:"styles-module__container___zbieC",text:"styles-module__text___24HRr",overlayContainer:"styles-module__overlayContainer___22prv",doubleDigitPadding:"styles-module__doubleDigitPadding___3SBrZ",bottomText:"styles-module__bottomText___CuLvb",iconContainer:"styles-module__iconContainer___6MdE2",weatherImage:"styles-module__weatherImage___27jgj",low:"styles-module__low___2_DU9",moderate:"styles-module__moderate___3pyZV",high:"styles-module__high___28ZM3",veryHigh:"styles-module__veryHigh___1wrRW",extreme:"styles-module__extreme___7oNtA"}},198:function(e,t,n){e.exports={container:"styles-module__container___3NrVj",numberAndName:"styles-module__numberAndName___2OX7B",orderNumber:"styles-module__orderNumber___3-UQt",nameText:"styles-module__nameText___e0hiA",descriptionText:"styles-module__descriptionText___1rBDe",latLng:"styles-module__latLng___1huPl",topSection:"styles-module__topSection___R3dTo",doneButton:"styles-module__doneButton___3zy10",dragHandle:"styles-module__dragHandle___2fGHB",coordinatesAndLanguageBtn:"styles-module__coordinatesAndLanguageBtn___LnghI"}},218:function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=n(2),a=function(e){var t=document.createElement("script");t.src="https://www.google.com/recaptcha/api.js?render=".concat(r.b.constants.GOOGLE_RECAPTCHA.SITE_KEY),t.async=!0,t.onload=function(){grecaptcha.ready((function(){e(grecaptcha)}))},document.body.appendChild(t)},o=function(e,t){return e.execute(r.b.constants.GOOGLE_RECAPTCHA.SITE_KEY,{action:t})},i=function(e,t){a((function(n){return o(n,e).then(t).catch((function(e){return console.error("RECAPTCHA ERROR",e)}))}))}},22:function(e,t,n){e.exports={head:"styles-module__head___1SNtp",foot:"styles-module__foot___RAJD-",subHead:"styles-module__subHead___Vj9C-",promptHead:"styles-module__promptHead___2WHam",step:"styles-module__step___1QhNX",prompt:"styles-module__prompt___25-9c",container:"styles-module__container___2M6iB",group:"styles-module__group___3eG_G",textField:"styles-module__textField___2FN1D",row:"styles-module__row___3Cl1w",col:"styles-module__col___3TSZa",inputItem:"styles-module__inputItem___3fpjx",action:"styles-module__action___k_W1_",link:"styles-module__link___m59rL",inputError:"styles-module__inputError___1Hv3E",inputGroup:"styles-module__inputGroup___2pEZJ",apply:"styles-module__apply___o1YnD",serverError:"styles-module__serverError___1fqh0",formUploadContainer:"styles-module__formUploadContainer___16tSt",clearContainer:"styles-module__clearContainer___3aylD",clearIcon:"styles-module__clearIcon___1PAjQ",trailDataAndClear:"styles-module__trailDataAndClear___2DTNn",title:"styles-module__title___1A_aZ",form:"styles-module__form___2IxS3",buttonContainer:"styles-module__buttonContainer___2mDbf",uploadButton:"styles-module__uploadButton___22rwi",cancelButton:"styles-module__cancelButton____-Oc3"}},237:function(e,t,n){"use strict";n.r(t);var r=n(160);n.d(t,"default",(function(){return r.a}))},246:function(e,t,n){e.exports={container:"styles-module__container___2Vdx5",text:"styles-module__text___1JbJG",iconImage:"styles-module__iconImage___1LS2f"}},247:function(e,t,n){e.exports={form:"styles-module__form___1outT",lngLat:"styles-module__lngLat___36bCc",textFieldContainer:"styles-module__textFieldContainer___kllDE",formToggle:"styles-module__formToggle___1wQJR",buttonAndLinks:"styles-module__buttonAndLinks___1iA7G",adminButton:"styles-module__adminButton___2V6PM",errorMessage:"styles-module__errorMessage___23Epo"}},302:function(e,t,n){"use strict";t.a=n.p+"media/shared/download-failed-new@3x-292cb5f7.png"},330:function(e,t,n){e.exports={container:"styles-module__container___3P2lZ",multiline:"styles-module__multiline___3fIHf",successCheck:"styles-module__successCheck___2AA50",ssrContainer:"styles-module__ssrContainer___3F4PL"}},346:function(e,t,n){e.exports={hidden:"styles-module__hidden___1AHdF",textAndBtnContainer:"styles-module__textAndBtnContainer___fj278",showMoreBtn:"styles-module__showMoreBtn___sKPVF",languageContainer:"styles-module__languageContainer___26fIT",trailDetailItemContainer:"styles-module__trailDetailItemContainer___1NHwo",displayText:"styles-module__displayText___2PIYE",rowReverse:"styles-module__rowReverse___2Ht9C",editButton:"styles-module__editButton___3u7zL",lineClamp:"styles-module__lineClamp___1KJx8",editSeoDescriptionCTA:"styles-module__editSeoDescriptionCTA___1HGGp",extendedDescription:"styles-module__extendedDescription___3WEL4"}},372:function(e,t,n){e.exports={dropdown:"styles-module__dropdown___1jYLT","dropdown-item":"styles-module__dropdown-item___VKHYE",suggest:"styles-module__suggest___3VyuS","trail-details":"styles-module__trail-details___1ooCW",gpxLabel:"styles-module__gpxLabel___3oCwv",dropdownItem:"styles-module__dropdownItem___2ERC8",disabled:"styles-module__disabled___1a0ez",proBadge:"styles-module__proBadge___1U8i3",printItem:"styles-module__printItem___1ACZf"}},374:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},391:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(54),a=function(e,t){return t?(t.id?r.s:r.d)(e,t):null},o=function(e,t){return t?(t.id?r.t:r.e)(e,t):null},i=function(e){return{name:e.name,description:e.description,location:e.location,waypointDisplayProperty:{showTitle:e.showTitle}}}},401:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(0),a=n.n(r),o=n(1),i=n(302),s=n(246),l=n.n(s),c=n(67),u=n(194),d=n(558),p=n(2),m=function(e){var t=e.updateProgressDialog,n=e.variant,o=function(){t(null)};Object(r.useEffect)((function(){["saved","error","error-deleting-map"].includes(n)&&setTimeout((function(){o()}),2e3)}),[n]);var s=function(e){switch(e){case"saving":return{element:a.a.createElement(u.a,null),text:"".concat(p.b.strings.MAP_CREATOR.SAVING_YOUR_MAP,"...")};case"error-saving":return{element:a.a.createElement("img",{src:i.a,className:l.a.iconImage,alt:p.b.strings.MAP_CREATOR.ERROR_SAVING}),text:p.b.strings.MAP_CREATOR.ERROR_SAVING};case"error":return{element:a.a.createElement("img",{src:i.a,className:l.a.iconImage,alt:p.b.strings.MAP_CREATOR.ERROR_SAVING}),text:p.b.strings.ERROR_OCCURRED};case"error-cannot-route":return{element:a.a.createElement("img",{src:i.a,className:l.a.iconImage,alt:p.b.strings.TRACK_DETAIL.CANNOT_ROUTE}),text:p.b.strings.TRACK_DETAIL.CANNOT_ROUTE};case"error-routing":return{element:a.a.createElement("img",{src:i.a,className:l.a.iconImage,alt:p.b.strings.TRACK_DETAIL.ERROR_ROUTING}),text:p.b.strings.TRACK_DETAIL.ERROR_ROUTING};case"error-deleting-map":return{element:a.a.createElement("img",{src:i.a,className:l.a.iconImage,alt:p.b.strings.TRACK_DETAIL.ERROR_DELETING}),text:p.b.strings.TRACK_DETAIL.ERROR_DELETING};case"loading":return{element:a.a.createElement(u.a,null),text:p.b.strings.SEARCH.LOADING};case"saved":return{element:a.a.createElement("img",{src:d.a,className:l.a.iconImage,alt:p.b.strings.MAP_CREATOR.MAP_SAVED}),text:"".concat(p.b.strings.MAP_CREATOR.MAP_SAVED,"!")};default:return{}}}(n),m=s.element,f=s.text;return a.a.createElement(c.a,{handleBackgroundClick:o},a.a.createElement("div",{className:l.a.container},m,a.a.createElement("div",{className:l.a.text},f)))};m.propTypes={variant:Object(o.oneOf)(["saving","error","error-cannot-route","error-routing","saved","error-deleting-map"]).isRequired,updateProgressDialog:o.func.isRequired};var f=m},404:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(564),l=n(535),c=n(534),u=n.n(c),d=n(9),p=n(360),m=n(23),f=n.n(m),g=n(22),b=n.n(g),h=n(330),y=n.n(h),_=Object(d.a)({root:{display:"flex",width:"100%",borderRadius:"16px",fontFamily:"Proxima Nova, Arial, sans-serif !important","& .MuiFormLabel-root":{fontFamily:"Proxima Nova, Arial, sans-serif !important",lineHeight:"8px"},"& .MuiFormLabel-root.MuiFormLabel-filled":{marginTop:"4px"},"& .MuiOutlinedInput-input":{padding:"10px 16px",margin:"4px 0px",borderRadius:"8px",color:"#414141",fontFamily:"Proxima Nova, Arial, sans-serif !important"},"& .MuiInputLabel-outlined":{color:"#b2aea7",zIndex:0},"& .MuiOutlinedInput-multiline":{padding:"0px"},"&.verticalResize .MuiOutlinedInput-input":{resize:"vertical"},"& input + fieldset":{borderRadius:"8px",color:"#767676",borderColor:"#e6e6e6"},"& input:valid:focus + fieldset":{borderLeftWidth:"2 !important",borderWidth:"2",borderColor:"#428A13 !important",color:"#428A13"},"& input:focus + fieldset":{color:"#428A13",borderColor:"#428A13 !important"},"&. .MuiFormHelperText-contained":{margin:"4px 14px"},"& .MuiFormLabel-root.Mui-error":{color:"red !important"},"& :hover .MuiOutlinedInput-notchedOutline":{borderColor:"#428A13 !important"},"& .MuiOutlinedInput-root":{borderRadius:"8px"},"& .MuiOutlinedInput-root.Mui-focused .MuiOutlinedInput-notchedOutline":{color:"#428A13 !important",borderColor:"#428A13 !important"},"& .MuiFormLabel-root.Mui-focused":{color:"#428A13",marginTop:"4px"},"& .MuiFormLabel-root.Mui-focused.Mui-error":{color:"red"},"& .MuiFormHelperText-root":{fontFamily:"Proxima Nova, Arial, sans-serif !important",color:"red !important"},"& .MuiOutlinedInput-root.Mui-error":{minHeight:"47px !important"},"& .MuiOutlinedInput-root.Mui-error .MuiOutlinedInput-notchedOutline":{fontFamily:"Proxima Nova, Arial, sans-serif !important",borderColor:"red !important",borderWidth:"2px",color:"red !important"}}})(s.a),v=function(e){var t=e.label;return a.a.createElement("div",{className:y.a.ssrContainer},t)},E=function(e){var t=e.adornment,n=e.autocomplete,r=e.changeHandler,o=e.className,i=e.enterKeyHandler,s=e.errorMessage,c=e.isDisabled,d=e.isRequired,m=e.isSuccess,g=e.label,h=e.name,E=e.type,O=e.multiline,w=e.verticalResize,T=e.rows,S=e.value,I=m?a.a.createElement(l.a,{position:"end"},a.a.createElement(u.a,{className:y.a.successCheck})):a.a.createElement(l.a,{position:"end"},t),x=(null===s||void 0===s?void 0:s.length)>0;return a.a.createElement(p.a,{fallback:a.a.createElement(v,{label:g})},a.a.createElement(_,{autoComplete:n,className:f()(o,y.a.container,x&&b.a.inputError,O&&y.a.multiline,w&&"verticalResize"),disabled:c,error:x,fullWidth:!0,helperText:x?s:"",InputProps:{endAdornment:I},label:g,name:h,onChange:r,onKeyPress:function(e){"Enter"===e.key&&i(e)},required:d,type:E,value:S,variant:"outlined",multiline:O,rows:T}))};E.defaultProps={adornment:a.a.createElement(a.a.Fragment,null),changeHandler:function(){},enterKeyHandler:function(){},errorMessage:"",isRequired:!1,label:"",multiline:!1,value:"",verticalResize:!1},E.propTypes={adornment:i.a.node,changeHandler:i.a.func,enterKeyHandler:i.a.func,errorMessage:i.a.string,isRequired:i.a.bool,label:i.a.string,multiline:i.a.bool,rows:i.a.number,value:i.a.string,verticalResize:i.a.bool},t.a=E},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(0),a=n.n(r),o=n(1),i=n(559),s=n(846),l=n(1092),c=n(527),u=n.n(c),d=n(155),p=n.p+"media/maps/more-green-ffc1aea4.svg",m=n(2);function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return g(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var b=function(e){var t=e.items,n=e.variant,o=f(Object(r.useState)(null),2),c=o[0],g=o[1],b=function(e){g(e.currentTarget)},h=function(){g(null)},y=Object(r.useCallback)((function(e){return function(){h(),t[e].callback()}})),_=Object(r.useMemo)((function(){return{default:{button:a.a.createElement("button",{className:u.a.button,title:m.b.strings.MORE_OPTIONS,"aria-haspopup":"true",type:"button",onClick:b},a.a.createElement(l.a,null)),transformOrigin:{vertical:-36,horizontal:156}},circle:{button:a.a.createElement(d.a,{className:u.a.circleIcon,icon:p,title:m.b.strings.MORE_OPTIONS,onClick:b}),transformOrigin:{vertical:-64,horizontal:132}}}}),[])[n],v=_.button,E=_.transformOrigin;return a.a.createElement("div",null,v,a.a.createElement(i.a,{anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:h,transformOrigin:E},t.map((function(e,t){var n=e.label.replace(" ","_");return a.a.createElement(s.a,{key:n,onClick:y(t),classes:{root:u.a.menuItemRoot}},e.label)}))))};b.propTypes={items:Object(o.arrayOf)(Object(o.shape)({label:o.string,callback:o.func})),variant:o.string},b.defaultProps={items:[],variant:"default"};var h=b},431:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(0),a=n.n(r),o=n(1),i=n(2),s=n(637),l=n.n(s),c=n(39),u=n(121),d=function(e){var t=e.onCancel,n=e.disabled;return a.a.createElement("div",{className:l.a.formButtonsContainer},a.a.createElement(c.a,{onClick:t,variant:"flat"},i.b.strings.CANCEL),"| ",a.a.createElement(u.a,{className:l.a.formButton,disabled:n,value:i.b.strings.SAVE}))},p=d;d.propTypes={onCancel:o.func.isRequired,disabled:o.bool},d.defaultProps={disabled:!1}},448:function(e,t,n){e.exports={card:"styles-module__card___8h_DS",backgroundImage:"styles-module__backgroundImage___-0eg8",content:"styles-module__content___1SJBw",name:"styles-module__name___2e_oK",starRatingWrapper:"styles-module__starRatingWrapper___1Olxf",reviewCount:"styles-module__reviewCount___V5Y6U",location:"styles-module__location___28W0h",badge:"styles-module__badge___3TEGu",favorite:"styles-module__favorite___17VyA",flex:"styles-module__flex___3Ykgu",clickable:"styles-module__clickable___2JSMd"}},449:function(e,t,n){e.exports={trailStatSection:"styles-module__trailStatSection___112ZI",trailStatIcons:"styles-module__trailStatIcons___2IMTE",detailData:"styles-module__detailData___2A8DK",statsLabel:"styles-module__statsLabel___VfPQj"}},454:function(e,t,n){"use strict";var r=n(374);Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=o.default.memo(o.default.forwardRef((function(t,n){return o.default.createElement(i.default,(0,a.default)({ref:n},t),e)})));0;return n.muiName=i.default.muiName,n};var a=r(n(819)),o=r(n(0)),i=r(n(237))},49:function(e,t,n){"use strict";var r=n(404);n.d(t,"a",(function(){return r.a}))},515:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(0),a=n.n(r),o=n(6),i=n(2),s=n(218),l=n(28)({displayName:"MapDownloadButton",getInitialState:function(){return{recaptchaReady:!1}},componentDidMount:function(){this.props.setRemoteRef&&this.props.setRemoteRef(this.showDownloadModal)},showWithCaptcha:function(){var e=this;Object(s.b)("downloadRoute",(function(t){e.props.useMessagingChannel?e.props.useMessagingChannel.publish({topic:"trail.download.modal",data:{colorboxOptions:function(n){return e.colorboxOptions(n,t)}}}):jQuery.colorbox(e.colorboxOptions(jQuery,t))}))},showDownloadModal:function(){var e=this;if(this.state.recaptchaReady)this.showWithCaptcha();else if("undefined"!==typeof grecaptcha)this.setState({recaptchaReady:!0}),this.showWithCaptcha();else{var t=document.createElement("script");t.src="https://www.google.com/recaptcha/api.js?render=".concat(i.b.constants.GOOGLE_RECAPTCHA.SITE_KEY),t.async=!0,t.onload=function(){grecaptcha.ready((function(){e.setState({recaptchaReady:!0}),e.showWithCaptcha()}))},document.body.appendChild(t)}},colorboxOptions:function(e,t){return{html:$("#map-download-modal-container").html(),width:"400px",height:"232px",onComplete:function(){e("button.cancel").click((function(){e.colorbox.close()})),e("button.ok").click(function(){e.colorbox.close();var n=e("#colorbox select#download").children("option:selected").val();_gaq.push(["_trackEvent","MapDownload",n,this.props.mapId?"Map":"Trail"]),this.props.mapId?window.location="/maps/".concat(this.props.mapId,"/gpx?key=").concat(o.a.apiKey,"&format=").concat(n,"&recaptcha=").concat(t):window.location="/".concat(this.props.trailSlug,"/gpx?ref=trail-more-gpx&format=").concat(n,"&recaptcha=").concat(t)}.bind(this))}.bind(this)}},render:function(){var e=this.props.btnText||i.b.strings.TRACK_DETAIL.DOWNLOAD_ROUTE,t=a.a.createElement("div",{id:"map-download-modal-container"},a.a.createElement("div",{id:"map-download-modal",className:"confirm-modal"},a.a.createElement("div",{className:"modal-container"},a.a.createElement("div",{className:"modal-header"},a.a.createElement("h3",null,e)),a.a.createElement("div",{className:"modal-body",onClick:this.closeModal},a.a.createElement("p",null,i.b.strings.TRACK_DETAIL.CHOOSE_FILE_FORMAT),a.a.createElement("select",{name:"filetype",id:"download",defaultValue:"gpxTrk"},a.a.createElement("option",{value:"gpxTrk"},"GPX Track"),a.a.createElement("option",{value:"kml"},"Google Earth KML"),a.a.createElement("option",{value:"tcx"},"Garmin Course TCX"),a.a.createElement("option",{value:"crs"},"Garmin Course CRS"),a.a.createElement("option",{value:"csv"},"CSV"),a.a.createElement("option",{value:"fit"},"Garmin FIT (ANT+)"),a.a.createElement("option",{value:"gpxRte"},"GPX Route"),a.a.createElement("option",{value:"kmz"},"Google Earth KMZ"),a.a.createElement("option",{value:"kmlGx"},"Google Earth Timeline"),a.a.createElement("option",{value:"kmlTour"},"Google Earth Tour"),a.a.createElement("option",{value:"ovl"},"OVL (ASCII)"),a.a.createElement("option",{value:"fugawi"},"Fugawi"),a.a.createElement("option",{value:"kompass"},"KOMPASS Verlag"),a.a.createElement("option",{value:"pcx5Trk"},"PCX5 Track"),a.a.createElement("option",{value:"geoRssTrk"},"GeoRSS Track"),a.a.createElement("option",{value:"excel"},"MS Excel"),a.a.createElement("option",{value:"oziExplorer"},"OziExplorer"),a.a.createElement("option",{value:"ikt"},"MagicMaps IKT"),a.a.createElement("option",{value:"falkTourRte"},"Falk IBEX Tour"),a.a.createElement("option",{value:"geoJsonTrk"},"GeoJSON Track"),a.a.createElement("option",{value:"jsonTrk"},"JSON Track"),a.a.createElement("option",{value:"pwtrk"},"PathAway"),a.a.createElement("option",{value:"navigon5Rte"},"Navigon RTE 5.x"),a.a.createElement("option",{value:"navigon6Rte"},"Navigon RTE 6.x"),a.a.createElement("option",{value:"freshroute"},"Navigon Freshroute"),a.a.createElement("option",{value:"magellanTrk"},"Magellan Track"),a.a.createElement("option",{value:"osynceTrk"},"o-synce Track"),a.a.createElement("option",{value:"compeGpsTrk"},"CompeGPS Track"),a.a.createElement("option",{value:"qpeGpsTrk"},"qpeGPS Track"),a.a.createElement("option",{value:"tomTomRte"},"TomTom ITN"),a.a.createElement("option",{value:"logbook"},"Garmin Logbook"),a.a.createElement("option",{value:"sqlTrk"},"SQL Inserts Track"),a.a.createElement("option",{value:"bddTdTrk"},"BDD (Bait dropping)"))),a.a.createElement("div",{className:"modal-footer"},a.a.createElement("div",{className:"btn-group"},a.a.createElement("button",{className:"cancel"},i.b.strings.CANCEL),a.a.createElement("button",{className:"ok"},i.b.strings.TRACK_DETAIL.START_DOWNLOAD))))));return this.props.styles?a.a.createElement("span",null,a.a.createElement("div",{className:this.props.styles.dropdownItem},a.a.createElement("a",{className:this.props.styles.gpxLabel,onClick:this.showDownloadModal,onMouseEnter:this.props.onMouseEnter},e)),t):this.props.modalOnly?t:a.a.createElement("span",null,a.a.createElement("span",{className:"btn btn-slim blue rounded write-review pull-right gpx-dl"},a.a.createElement("a",{onClick:this.showDownloadModal},e)),t)}});l.defaultProps={setRemoteRef:null}},523:function(e,t,n){e.exports={roundButtonBase:"styles-module__roundButtonBase___2GOnW",largeButton:"styles-module__largeButton___3b-n7",smallButton:"styles-module__smallButton___ulmRt",proBadge:"styles-module__proBadge___1TMuk"}},527:function(e,t,n){e.exports={button:"styles-module__button___2tYDX",menuItemRoot:"styles-module__menuItemRoot___1a6Jy",circleIcon:"styles-module__circleIcon___2nuc5"}},528:function(e,t,n){e.exports={container:"styles-module__container___39nZm",newWaypointContainer:"styles-module__newWaypointContainer___39BFS",adminButtons:"styles-module__adminButtons___1ZCBH"}},534:function(e,t,n){"use strict";var r=n(374);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(0)),o=(0,r(n(454)).default)(a.default.createElement("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckCircle");t.default=o},535:function(e,t,n){"use strict";var r=n(3),a=n(5),o=n(0),i=(n(1),n(7)),s=n(352),l=n(9),c=n(136),u=o.forwardRef((function(e,t){var n=e.children,l=e.classes,u=e.className,d=e.component,p=void 0===d?"div":d,m=e.disablePointerEvents,f=void 0!==m&&m,g=e.disableTypography,b=void 0!==g&&g,h=e.position,y=e.variant,_=Object(a.a)(e,["children","classes","className","component","disablePointerEvents","disableTypography","position","variant"]),v=Object(c.b)()||{},E=y;return y&&v.variant,v&&!E&&(E=v.variant),o.createElement(c.a.Provider,{value:null},o.createElement(p,Object(r.a)({className:Object(i.a)(l.root,u,f&&l.disablePointerEvents,v.hiddenLabel&&l.hiddenLabel,"filled"===E&&l.filled,{start:l.positionStart,end:l.positionEnd}[h],"dense"===v.margin&&l.marginDense),ref:t},_),"string"!==typeof n||b?n:o.createElement(s.a,{color:"textSecondary"},n)))}));t.a=Object(l.a)({root:{display:"flex",height:"0.01em",maxHeight:"2em",alignItems:"center",whiteSpace:"nowrap"},filled:{"&$positionStart:not($hiddenLabel)":{marginTop:16}},positionStart:{marginRight:8},positionEnd:{marginLeft:8},disablePointerEvents:{pointerEvents:"none"},hiddenLabel:{},marginDense:{}},{name:"MuiInputAdornment"})(u)},54:function(e,t,n){"use strict";n.d(t,"a",(function(){return y})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return _})),n.d(t,"e",(function(){return E})),n.d(t,"f",(function(){return b})),n.d(t,"g",(function(){return w})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return a})),n.d(t,"k",(function(){return c})),n.d(t,"l",(function(){return h})),n.d(t,"m",(function(){return i})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"p",(function(){return f})),n.d(t,"q",(function(){return s})),n.d(t,"r",(function(){return l})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return O}));var r=n(15),a=function(e){return Object(r.b)({resReducer:function(e){return e.trails[0].defaultMap},url:"/api/alltrails/trails/".concat(e,"?detail=offline&include_pending=true")})},o=function(e){var t,n,o=e.ID;return"trail"===e.type?a(o):(t=o,n="deep",Object(r.b)({resReducer:function(e){return e.maps[0]},url:"/api/alltrails/maps/".concat(t,"?detail=").concat(n)}))},i=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.b)({data:{apply_map_rules:t.apply_map_rules||"true",combine_segments:t.combine_segments||"false",detail:t.detail||"deep",map:e,system_owned:t.system_owned},resReducer:function(e){return e.maps[0]},type:"POST",url:"/api/alltrails/maps"})},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(r.b)({data:{apply_map_rules:t.apply_map_rules||"true",combine_segments:t.combine_segments||"false",detail:t.detail||"deep",map:e},resReducer:function(e){return e.maps[0]},type:"PUT",url:"/api/alltrails/maps/".concat(e.id)})},l=function(e,t){return Object(r.b)({data:t,resReducer:function(e){return e.maps[0].map},type:"POST",url:"/api/alltrails/maps/".concat(e,"/metadata")})},c=function(e,t){return Object(r.b)({data:{from_trail_id:t},type:"POST",url:"/api/alltrails/maps/".concat(e,"/remove")})},u=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"deep";return Object(r.b)({data:{detail:n,name:t},resReducer:function(e){return e.maps[0]},type:"POST",url:"/api/alltrails/trails/".concat(e,"/verified/copy")})},d=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"deep";return Object(r.b)({data:{detail:n,name:t},resReducer:function(e){return e.maps[0]},type:"POST",url:"/api/alltrails/maps/".concat(e,"/copy")})},p=function(e,t,n,a){return Object(r.b)({data:{at_line_segment_id:t,crop_idx:n,new_end_pt:a},resReducer:function(e){return e.maps[0]},type:"PUT",url:"/api/alltrails/maps/".concat(e,"/endpoint/edit")})},m=function(e,t,n){return Object(r.b)({data:n,resReducer:function(e){return e.waypoints[0]},type:"PUT",url:"/api/alltrails/maps/".concat(e,"/waypoints/").concat(t)})},f=function(e,t){return Object(r.b)({data:t,type:"PUT",url:"/api/alltrails/maps/".concat(e,"/waypoints/all")})},g=function(e,t){return Object(r.b)({type:"DELETE",url:"/api/alltrails/maps/".concat(e,"/waypoints/").concat(t)})},b=function(e){return Object(r.b)({type:"DELETE",url:"/api/alltrails/maps/".concat(e,"/waypoints/all")})},h=function(e,t){return Object(r.b)({data:{ordered_waypoint_ids:t},resReducer:function(e){return e.waypoints},type:"POST",url:"/api/alltrails/maps/".concat(e,"/waypoints/reorder")})},y=function(e,t){return Object(r.b)({data:{description:t.description_source?t.description_source:t.description,latitude:t.location.latitude,longitude:t.location.longitude,name:t.name_source?t.name_source:t.name},resReducer:function(e){return e.waypoints[0]},type:"POST",url:"/api/alltrails/trails/".concat(e,"/waypoints")})},_=function(e,t){return Object(r.b)({data:{route:{lineDisplayProperty:t.lineDisplayProperty,lineSegments:t.lineSegments}},resReducer:function(e){return e.maps[0]},type:"POST",url:"/api/alltrails/maps/".concat(e,"/routes")})},v=function(e,t){return Object(r.b)({data:{route:{lineDisplayProperty:t.lineDisplayProperty,lineSegments:t.lineSegments}},resReducer:function(e){return e.maps[0]},type:"PUT",url:"/api/alltrails/maps/".concat(e,"/routes/").concat(t.id)})},E=function(e,t){return Object(r.b)({data:{description:t.description,latitude:t.location.latitude,longitude:t.location.longitude,name:t.name,showTitle:t.showTitle},resReducer:function(e){return e.waypoints[0]},type:"POST",url:"/api/alltrails/maps/".concat(e,"/waypoints")})},O=function(e,t){return Object(r.b)({data:{description:t.description,latitude:t.location.latitude,longitude:t.location.longitude,name:t.name,showTitle:t.showTitle},resReducer:function(e){return e.waypoints[0]},type:"PUT",url:"/api/alltrails/maps/".concat(e,"/waypoints/").concat(t.id)})},w=function(e){return Object(r.b)({resReducer:function(e){return e},type:"DELETE",url:"/api/alltrails/maps/".concat(e)})}},558:function(e,t,n){"use strict";t.a=n.p+"media/share/filled@2x-972bd466.png"},563:function(e,t,n){"use strict";n.d(t,"a",(function(){return q}));var r=n(0),a=n.n(r),o=n(1),i=n(51),s=n(528),l=n.n(s),c=n(39),u=n(41),d=n(124),p=n(939),m=n(198),f=n.n(m),g=n(162),b=n(430),h=n(2);function y(){return(y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var _=function(e){var t,n,o,i=e.id,s=e.idx,l=e.name,c=e.name_source,u=e.name_unsupported_language,d=e.description,m=e.description_source,_=e.description_unsupported_language,v=e.location,E=e.editWaypoint,O=e.deleteWaypoint,w=e.toggleSortMode,T=e.totalWaypointsLength,S=e.sortMode,I=e.provided,x=e.persistWaypointOrder,C=e.canEdit,j=e.isAdmin,R=e.handleMouseOver,P=e.toggleLanguageOrigin,A=e.showInTranslatedLang,N=e.enable_translations,k=v.latitude,M=v.longitude;if(C){var D=[{label:h.b.strings.DELETE,callback:Object(r.useCallback)((function(){O(i)}),[s])}];N&&(u||_)?j&&D.unshift({label:"Edit Translations",callback:Object(r.useCallback)((function(){var e="/edit-translations?table=at_map_markers&column_name=name&id=".concat(i);window.open(e,"_blank")}),[s])}):D.unshift({label:h.b.strings.EDIT,callback:Object(r.useCallback)((function(){E(s)}),[s])}),T>1&&D.push({label:h.b.strings.SORT.SORT,callback:w}),t=a.a.createElement(b.a,{items:D})}(c||m)&&(o=function(){P(s,A)},n=a.a.createElement(g.a,{active:A,handleClick:o}));var L=!A&&c?c:l,B=!A&&m?m:d;return a.a.createElement("div",{className:f.a.container,onMouseEnter:function(){return R(i,v)}},a.a.createElement("div",{className:f.a.topSection},a.a.createElement("div",{className:f.a.numberAndName},I&&C&&a.a.createElement("span",y({},I.dragHandleProps,{title:"Reorder"}),a.a.createElement(p.a,{className:f.a.dragHandle})),a.a.createElement("div",{className:f.a.orderNumber},s+1),a.a.createElement("div",{className:f.a.nameText},L)),S?a.a.createElement("button",{type:"button",className:f.a.doneButton,onClick:x},h.b.strings.DONE):t),a.a.createElement("div",{className:f.a.descriptionText},B),a.a.createElement("div",{className:f.a.coordinatesAndLanguageBtn},a.a.createElement("div",{className:f.a.latLng},k,", ",M),n))};_.propTypes={id:o.number,idx:o.number.isRequired,name:o.string,description:o.string,location:Object(o.shape)({latitude:o.number,longitude:o.number}),editWaypoint:o.func,deleteWaypoint:o.func,toggleSortMode:o.func,totalWaypointsLength:o.number,sortMode:o.bool,provided:i.c,persistWaypointOrder:o.func,canEdit:o.bool,isAdmin:o.bool,handleMouseOver:o.func,totalWaypointsNumber:o.number,showInTranslatedLang:o.bool,name_source:o.string,name_unsupported_language:o.bool,description_source:o.string,description_unsupported_language:o.bool,toggleLanguageOrigin:o.func,enable_translations:o.bool},_.defaultProps={provided:null,handleMouseOver:function(){},id:null,name:"",description:"",location:{latitude:null,longitude:null},editWaypoint:function(){},deleteWaypoint:function(){},toggleSortMode:function(){},totalWaypointsNumber:1,sortMode:o.bool,persistWaypointOrder:function(){},canEdit:!1,isAdmin:!1,totalWaypointsLength:1,showInTranslatedLang:!1,name_source:null,name_unsupported_language:!1,description_source:null,description_unsupported_language:!1,toggleLanguageOrigin:function(){},enable_translations:!1};var v=_,E=n(80),O=n(247),w=n.n(O),T=n(49),S=n(431),I=n(168),x=n(77),C=n(54),j=n(391);function R(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?R(Object(n),!0).forEach((function(t){A(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):R(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return k(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return k(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function k(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function M(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var D=function(e){var t=e.id,n=e.dispatchWaypoints,o=e.messagingChannel,i=e.mapId,s=e.trailId,l=e.isAdmin,c=e.createMapWithWaypoint,u=e.dispatchFormState,d=M(e,["id","dispatchWaypoints","messagingChannel","mapId","trailId","isAdmin","createMapWithWaypoint","dispatchFormState"]),p=N(Object(r.useState)({description:d.description,location:d.location,name:d.name,showTitle:!s&&d.waypointDisplayProperty.showTitle}),2),m=p[0],f=p[1],g=N(Object(r.useState)(!1),2),b=g[0],y=g[1],_=N(Object(r.useState)(""),2),v=_[0],O=_[1],R=Object(E.debounce)((function(){var e=P(P({},m),{},{id:t});n({payload:e,type:x.l})}),1e3);Object(r.useEffect)((function(){u&&R()}),[m]);var k=function(e){n({payload:e,type:x.b})},D=function(e){y(!1),O(h.b.strings.MAP_CREATOR.WAYPOINT_ERROR)},L=function(e){var t=e.location,n=t.latitude,r=t.longitude,a={latitude:n.toFixed(5),longitude:r.toFixed(5)};f((function(e){return P(P({},e),{},{location:a})}))};Object(r.useEffect)((function(){o&&o.subscribe("waypoint.dragged.with_location",L)}),[]);var B=function(e){var t=e.currentTarget.name,n=e.currentTarget.value;f((function(e){return P(P({},e),{},A({},t,n))}))},U=function(e){var t=e.currentTarget.value,n=e.currentTarget.name,r=P(P({},m.location),{},A({},n,t));f(P(P({},m),{},{location:r}))};return a.a.createElement("form",{className:w.a.form,onSubmit:function(e){var n;e.preventDefault(),t?Object(C.t)(i,P(P({},m),{},{id:t})).then(k).catch(D):(n=!i||s?Object(j.a)(m):m,s?Object(C.a)(s,n).then(k).catch(D):i||!c?Object(C.e)(i,n).then(k).catch(D):c(n))}},a.a.createElement("div",{className:w.a.textFieldContainer},a.a.createElement(T.a,{name:"name",value:m.name,label:h.b.strings.TITLE,changeHandler:B})),a.a.createElement("div",{className:w.a.textFieldContainer},a.a.createElement(T.a,{name:"description",value:m.description,label:h.b.strings.TAB_NAMES.DESCRIPTION,changeHandler:B,multiline:!0,verticalResize:!0,rows:3})),a.a.createElement("div",{className:w.a.lngLat},a.a.createElement(T.a,{name:"latitude",value:m.location.latitude,label:h.b.strings.LATITUDE,changeHandler:U}),a.a.createElement(T.a,{name:"longitude",value:m.location.longitude,label:h.b.strings.LONGITUDE,changeHandler:U})),!s&&a.a.createElement(I.a,{className:w.a.formToggle,inputId:"showTitle",checked:m.showTitle,onChange:function(){var e=m.showTitle;f((function(t){return P(P({},t),{},{showTitle:!e})}))},"arial-label":h.b.strings.TRACK_DETAIL.SHOW_TITLE_ON_MAP,label:h.b.strings.TRACK_DETAIL.SHOW_TITLE_ON_MAP}),v&&a.a.createElement("div",{className:w.a.errorMessage},v),a.a.createElement("div",{className:w.a.buttonAndLinks},a.a.createElement(S.a,{onCancel:function(){n({type:x.c})},disabled:b}),l&&t&&a.a.createElement("a",{className:w.a.adminButton,href:"/edit-translations?table=at_map_markers&column_name=name&id=".concat(t),rel:"noreferrer",target:"_blank"},"Edit Translations")))};D.propTypes={description:o.string,createMapWithWaypoint:o.func,dispatchWaypoints:o.func,dispatchFormState:o.bool,id:o.number,isAdmin:o.bool,location:Object(o.shape)({latitude:o.number,longitude:o.number}),mapId:o.number,messagingChannel:o.object,name:o.string,trailId:o.number,waypointDisplayProperty:Object(o.shape)({showTitle:o.bool})},D.defaultProps={createMapWithWaypoint:null,description:"",dispatchFormState:!1,dispatchWaypoints:function(){},id:null,isAdmin:!1,location:{latitude:"",longitude:""},mapId:null,messagingChannel:null,name:"",trailId:null,waypointDisplayProperty:{showTitle:!0}};var L=D;function B(){return(B=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var H=function(e){var t,n,o,i,s,l=e.waypoints,c=e.editIndex,p=e.dispatchWaypoints,m=e.messagingChannel,f=e.mapId,g=e.sortMode,b=e.canEdit,y=e.trailId,_=e.isAdmin,E=e.createMapWithWaypoint,O=e.dispatchFormState;b&&(t=function(e){b&&p({type:x.j,payload:e})},n=function(e){b&&confirm(h.b.strings.TRACK_DETAIL.DELETE_WP_QUESTION)&&Object(C.h)(f,e).then((function(){p({type:x.e,payload:e})}))},o=function(){var e=l.map((function(e){return e.id}));Object(C.l)(f,e).then((function(){p({type:x.i,payload:!1})}))},i=Object(r.useCallback)((function(){p({type:x.i,payload:!g})}),[g]),s=function(e){var t=Object(u.reorder)(l,e.source.index,e.destination.index).map((function(e,t){return F(F({},e),{},{order:t+1})}));p({type:x.f,payload:t})});var w=function(e,t){m&&m.publish({topic:"waypoint.hover",data:{id:e,location:t}})};if(g){return a.a.createElement(d.a,{onDragEnd:s},a.a.createElement(d.c,{droppableId:"droppable"},(function(e){return a.a.createElement("ul",B({},e.droppableProps,{ref:e.innerRef}),l.map((function(e,t){return function(e,t){return a.a.createElement(d.b,{key:"".concat(e.id),draggableId:"".concat(e.id),index:t},(function(n){return a.a.createElement("li",B({ref:n.innerRef},n.draggableProps),a.a.createElement(v,B({},e,{provided:n,sortMode:g,canEdit:b,key:e.id,idx:t,toggleSortMode:i,persistWaypointOrder:o})))}))}(e,t)})),e.placeholder)})))}var T=function(e,t){p({type:x.h,payload:{idx:e,showInTranslatedLang:!t}})};return l.map((function(e,r){return r===c&&b?a.a.createElement(L,B({key:"waypoint-form"},e,{dispatchWaypoints:p,messagingChannel:m,mapId:f,trailId:y,isAdmin:_,createMapWithWaypoint:E,dispatchFormState:O})):a.a.createElement(v,B({key:e.id},e,{idx:r,editWaypoint:t,deleteWaypoint:n,totalWaypointsLength:l.length,toggleSortMode:i,sortMode:g,canEdit:b,isAdmin:_,handleMouseOver:w,toggleLanguageOrigin:T}))}))};H.propTypes={waypoints:Object(o.arrayOf)(i.f),dispatchWaypoints:o.func,editIndex:o.number,messagingChannel:o.object,mapId:o.number,sortMode:o.bool,canEdit:o.bool,trailId:o.number,isAdmin:o.bool,dispatchFormState:o.bool},H.defaultProps={trailId:null,waypoints:[],editIndex:null,messagingChannel:null,mapId:null,sortMode:!1,canEdit:!1,isAdmin:!1,dispatchFormState:!1};var G=H,K=function(e){var t,n=e.waypoints,r=e.dispatchWaypoints,o=e.editIndex,i=e.messagingChannel,s=e.mapId,u=e.sortMode,d=e.canEdit,p=e.trailId,m=e.isAdmin,f=e.createMapWithWaypoint,g=e.dispatchFormState;if(d){var b,y;if(null===o){b=a.a.createElement("div",{className:l.a.newWaypointContainer},a.a.createElement(c.a,{variant:"secondary",onClick:function(){r({type:x.a})}},h.b.strings.ADD_NEW_WAYPOINT))}if(null===o&&n.length>0){var _=h.b.strings.TRACK_DETAIL,v=function(){return!!p||n.every((function(e){return e.waypointDisplayProperty.showTitle}))};y=a.a.createElement("div",{className:l.a.adminButtons},a.a.createElement(c.a,{variant:"flat",onClick:function(e){e.preventDefault(),!d||n.length<1||!confirm(h.b.strings.TRACK_DETAIL.DELETE_ALL_WP_QUESTION)||Object(C.f)(s).then((function(){r({type:x.d})}))}},h.b.strings.TRACK_DETAIL.DELETE_ALL),"|",a.a.createElement(c.a,{variant:"flat",onClick:function(){if(d&&!(n.length<1)){var e=!v();Object(C.p)(s,{showTitle:e}).then((function(){r({type:x.g,payload:e})}))}}},v()?_.HIDE_ALL_WPS:_.SHOW_ALL_WPS),"|",a.a.createElement(c.a,{variant:"flat",onClick:function(e){if(e.preventDefault(),d&&!(n.length<1)){var t=n.map((function(e){return e.id})).filter((function(e){return!!e})).reverse();Object(C.l)(s,t).then((function(e){r({type:x.f,payload:e})}))}}},_.REVERSE_ORDER))}t=a.a.createElement(a.a.Fragment,null,b,y)}return a.a.createElement("div",{className:l.a.container},a.a.createElement(G,{waypoints:n,editIndex:o,dispatchWaypoints:r,messagingChannel:i,mapId:s,sortMode:u,canEdit:d,trailId:p,isAdmin:m,createMapWithWaypoint:f,dispatchFormState:g}),t)};K.propTypes={waypoints:Object(o.arrayOf)(i.f),dispatchWaypoints:o.func,editIndex:o.number,messagingChannel:o.object,mapId:o.number,sortMode:o.bool,canEdit:o.bool,trailId:o.number,isAdmin:o.bool,createMapWithWaypoint:o.func,dispatchFormState:o.bool},K.defaultProps={trailId:null,dispatchWaypoints:function(){},waypoints:[],editIndex:null,messagingChannel:null,mapId:null,sortMode:!1,canEdit:!1,isAdmin:!1,createMapWithWaypoint:null,dispatchFormState:!1};var q=K},578:function(e,t,n){e.exports={root:"styles-module__root___2JJGH",list:"styles-module__list___2MTCy",activeDayLight:"styles-module__activeDayLight___3He2E",loadingSpinnerContainer:"styles-module__loadingSpinnerContainer___31aT3"}},592:function(e,t,n){e.exports={triggerContainer:"styles-module__triggerContainer___poA33",dropdownContainer:"styles-module__dropdownContainer___1NU2o",dropdownButton:"styles-module__dropdownButton___tehzm"}},637:function(e,t,n){e.exports={formButtonsContainer:"styles-module__formButtonsContainer___3ArJp",formButton:"styles-module__formButton___zAvhG"}},641:function(e,t,n){e.exports={container:"styles-module__container___3xX3H",text:"styles-module__text___3ntJy",proImageContainer:"styles-module__proImageContainer___1rtpv",proImage:"styles-module__proImage___2SDFu",arrowImageContainer:"styles-module__arrowImageContainer___3R9c0",arrowImage:"styles-module__arrowImage___1iMma"}},642:function(e,t,n){e.exports={container:"styles-module__container___2JWpY",link:"styles-module__link___2kkVy",viewFullMap:"styles-module__viewFullMap___1EIbz",germanText:"styles-module__germanText___1vg-T",mapImage:"styles-module__mapImage___2n10y",expandIcon:"styles-module__expandIcon___17n_W"}},738:function(e,t,n){"use strict";t.a=n.p+"media/share/map-expand@2x-2519a898.png"},739:function(e,t,n){"use strict";n.d(t,"a",(function(){return g}));var r=n(0),a=n.n(r),o=n(1),i=n(782),s=n.n(i),l=n(51),c=n(563),u=n(77);function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return m(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return m(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var f=function(e){var t=e.waypoints,n=e.canEdit,r=e.messagingChannel,o=e.mapId,i=e.trailId,l=e.isAdmin,m=p(Object(u.m)({initialWaypoints:t,messagingChannel:r,canEdit:n}),2),f=m[0],g=m[1];return a.a.createElement("div",{className:s.a.container},a.a.createElement(c.a,d({},f,{dispatchWaypoints:g,messagingChannel:r,mapId:o,canEdit:n,trailId:i,isAdmin:l})))};f.propTypes={messagingChannel:o.object,trailId:o.number,waypoints:Object(o.arrayOf)(l.f),canEdit:o.bool,mapId:o.number,isAdmin:o.bool},f.defaultProps={messagingChannel:null,trailId:null,waypoints:[],canEdit:!1,mapId:null,isAdmin:!1};var g=f},743:function(e,t,n){e.exports={buttonContainer:"styles-module__buttonContainer___1oEHI",formButton:"styles-module__formButton___ybwRf"}},77:function(e,t,n){"use strict";n.d(t,"m",(function(){return I})),n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return _})),n.d(t,"g",(function(){return E})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return w})),n.d(t,"l",(function(){return T}));var r=n(0);function a(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"===typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){u(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={id:null,name:"",description:"",location:{longitude:null,latitude:null},waypointDisplayProperty:{showTitle:!0}},p=function(e){return e.filter((function(e){return null!==e.location})).sort((function(e,t){return e.order-t.order}))},m="ADD_NEW_WAYPOINT_FORM",f="UPDATE_EDIT_INDEX",g="CANCEL_WAYPOINT_FORM",b="ADD_PERSISTED_WAYPOINT",h="REMOVE_WAYPOINT",y="TOGGLE_SORT_MODE",_="REORDER_WAYPOINTS",v="DELETE_ALL_WAYPOINTS",E="TOGGLE_SHOW_ALL_TITLES",O="TOGGLE_SHOW_TRANLSATED_LANG",w="UPDATE_FOR_INCOMING_WAYPOINTS",T="UPDATE_WAYPOINT_EDIT_PARAMS",S=function(e,t){switch(t.type){case m:return c(c({},e),{},{waypoints:[].concat(o(e.waypoints),[d]),editIndex:e.waypoints.length});case f:return c(c({},e),{},{editIndex:t.payload});case g:return c(c({},e),{},{editIndex:null,editParams:null,waypoints:e.waypoints.filter((function(e){return null!==e.id}))});case h:return c(c({},e),{},{waypoints:e.waypoints.filter((function(e){return e.id!==t.payload}))});case y:return c(c({},e),{},{sortMode:t.payload,editIndex:null});case b:return c(c({},e),{},{editIndex:null,editParams:null,waypoints:e.waypoints.map((function(n,r){return r===e.editIndex?c({},t.payload):n}))});case _:return c(c({},e),{},{waypoints:t.payload});case v:return c(c({},e),{},{waypoints:[]});case E:return c(c({},e),{},{waypoints:e.waypoints.map((function(e){return c(c({},e),{},{waypointDisplayProperty:{showTitle:t.payload}})}))});case O:return c(c({},e),{},{waypoints:e.waypoints.map((function(e,n){return n===t.payload.idx?c(c({},e),{},{showInTranslatedLang:t.payload.showInTranslatedLang}):e}))});case w:return c(c({},e),{},{editIndex:null,waypoints:o(p(t.payload))});case T:return c(c({},e),{},{editParams:t.payload});default:return e}},I=function(e){var t=e.initialWaypoints,n=void 0===t?[]:t,o=e.messagingChannel,i=void 0===o?null:o,s=e.canEdit,l=void 0!==s&&s,u={waypoints:p(n),newWaypointParams:d,editIndex:null,sortMode:!1,editParams:null},m=a(Object(r.useReducer)(S,c({},u)),2),f=m[0],g=m[1],b=Object(r.useRef)(f);if(!l)return[u,null];Object(r.useEffect)((function(){if(i){var e=f.editIndex,t=f.waypoints,n=t[e],r="undefined"===typeof n?0:n.id;i.publish({topic:"waypointsChanged",data:{waypoints:t,editWaypointId:r,activeWaypoint:n}})}}),[f.editIndex,f.waypoints]);return Object(r.useEffect)((function(){b.current=f}),[f]),[f,function(e){var t=e.type,n=e.payload;g({type:t,payload:void 0===n?{}:n})}]}},773:function(e,t,n){e.exports={submit:"styles-module__submit___34BHy"}},782:function(e,t,n){e.exports={container:"styles-module__container___2yDTi"}},806:function(e,t,n){e.exports={mainActionBar:"styles-module__mainActionBar___186Wf",list:"styles-module__list___25zV9",mobileHide:"styles-module__mobileHide___ZkFz8"}},819:function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},846:function(e,t,n){"use strict";var r=n(5),a=n(27),o=n(3),i=n(0),s=(n(1),n(7)),l=n(9),c=n(466),u=n(259),d=n(32),p=n(300),m=n(14),f="undefined"===typeof window?i.useEffect:i.useLayoutEffect,g=i.forwardRef((function(e,t){var n=e.alignItems,a=void 0===n?"center":n,l=e.autoFocus,g=void 0!==l&&l,b=e.button,h=void 0!==b&&b,y=e.children,_=e.classes,v=e.className,E=e.component,O=e.ContainerComponent,w=void 0===O?"li":O,T=e.ContainerProps,S=(T=void 0===T?{}:T).className,I=Object(r.a)(T,["className"]),x=e.dense,C=void 0!==x&&x,j=e.disabled,R=void 0!==j&&j,P=e.disableGutters,A=void 0!==P&&P,N=e.divider,k=void 0!==N&&N,M=e.focusVisibleClassName,D=e.selected,L=void 0!==D&&D,B=Object(r.a)(e,["alignItems","autoFocus","button","children","classes","className","component","ContainerComponent","ContainerProps","dense","disabled","disableGutters","divider","focusVisibleClassName","selected"]),U=i.useContext(p.a),F={dense:C||U.dense||!1,alignItems:a},W=i.useRef(null);f((function(){g&&W.current&&W.current.focus()}),[g]);var H=i.Children.toArray(y),G=H.length&&Object(u.a)(H[H.length-1],["ListItemSecondaryAction"]),K=i.useCallback((function(e){W.current=m.findDOMNode(e)}),[]),q=Object(d.a)(K,t),z=Object(o.a)({className:Object(s.a)(_.root,v,F.dense&&_.dense,!A&&_.gutters,k&&_.divider,R&&_.disabled,h&&_.button,"center"!==a&&_.alignItemsFlexStart,G&&_.secondaryAction,L&&_.selected),disabled:R},B),V=E||"li";return h&&(z.component=E||"div",z.focusVisibleClassName=Object(s.a)(_.focusVisible,M),V=c.a),G?(V=z.component||E?V:"div","li"===w&&("li"===V?V="div":"li"===z.component&&(z.component="div")),i.createElement(p.a.Provider,{value:F},i.createElement(w,Object(o.a)({className:Object(s.a)(_.container,S),ref:q},I),i.createElement(V,z,H),H.pop()))):i.createElement(p.a.Provider,{value:F},i.createElement(V,Object(o.a)({ref:q},z),H))})),b=Object(l.a)((function(e){return{root:{display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",width:"100%",boxSizing:"border-box",textAlign:"left",paddingTop:8,paddingBottom:8,"&$focusVisible":{backgroundColor:e.palette.action.selected},"&$selected, &$selected:hover":{backgroundColor:e.palette.action.selected},"&$disabled":{opacity:.5}},container:{position:"relative"},focusVisible:{},dense:{paddingTop:4,paddingBottom:4},alignItemsFlexStart:{alignItems:"flex-start"},disabled:{},divider:{borderBottom:"1px solid ".concat(e.palette.divider),backgroundClip:"padding-box"},gutters:{paddingLeft:16,paddingRight:16},button:{transition:e.transitions.create("background-color",{duration:e.transitions.duration.shortest}),"&:hover":{textDecoration:"none",backgroundColor:e.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}},secondaryAction:{paddingRight:48},selected:{}}}),{name:"MuiListItem"})(g),h=i.forwardRef((function(e,t){var n,a=e.classes,l=e.className,c=e.component,u=void 0===c?"li":c,d=e.disableGutters,p=void 0!==d&&d,m=e.ListItemClasses,f=e.role,g=void 0===f?"menuitem":f,h=e.selected,y=e.tabIndex,_=Object(r.a)(e,["classes","className","component","disableGutters","ListItemClasses","role","selected","tabIndex"]);return e.disabled||(n=void 0!==y?y:-1),i.createElement(b,Object(o.a)({button:!0,role:g,tabIndex:n,component:u,selected:h,disableGutters:p,classes:Object(o.a)({dense:a.dense},m),className:Object(s.a)(a.root,l,h&&a.selected,!p&&a.gutters),ref:t},_))}));t.a=Object(l.a)((function(e){return{root:Object(o.a)({},e.typography.body1,Object(a.a)({minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",width:"auto",overflow:"hidden",whiteSpace:"nowrap"},e.breakpoints.up("sm"),{minHeight:"auto"})),gutters:{},selected:{},dense:Object(o.a)({},e.typography.body2,{minHeight:"auto"})}}),{name:"MuiMenuItem"})(h)},880:function(e,t,n){"use strict";n.d(t,"a",(function(){return D}));var r=n(0),a=n.n(r),o=n(1),i=n.n(o),s=n(258),l=n(421),c=n(197),u=n.n(c);function d(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return p(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return p(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var m=function(e){var t=e.topText,n=e.bottomText,o=e.imgSrc,i=e.srcSet,s=e.overlay,l=d(Object(r.useState)(!1),2),c=l[0],p=l[1];return a.a.createElement("li",{key:"weather-day-".concat(t),className:u.a.container},a.a.createElement("h3",{className:u.a.text},t),a.a.createElement("div",{className:u.a.iconContainer},a.a.createElement("div",{className:u.a.overlayContainer},c&&s),a.a.createElement("img",{onLoad:function(){return p(!0)},className:u.a.weatherImage,alt:t,src:o,srcSet:i})),a.a.createElement("h4",{className:"".concat(u.a.text," ").concat(u.a.bottomText)},n))};m.propTypes={topText:i.a.string,bottomText:i.a.string,imgSrc:i.a.string,srcSet:i.a.arrayOf(i.a.string),overlay:i.a.element},m.defaultProps={topText:"",bottomText:"",imgSrc:"",srcSet:[""],overlay:a.a.createElement(a.a.Fragment,null)};var f=m,g=n(578),b=n.n(g),h=n(6),y=n(2),_=function(e,t){var n="";return e>9&&(n+="".concat(u.a.doubleDigitPadding," ")),n+=function(e){switch(e){case"low":return u.a.low;case"moderate":return u.a.moderate;case"high":return u.a.high;case"very-high":return u.a.veryHigh;case"extreme":return u.a.extreme;default:return""}}(t),a.a.createElement("span",{className:n},e)},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"en-US",t=arguments.length>1?arguments[1]:void 0,n=new Date(t.slice(0,19));return new Intl.DateTimeFormat(e,{timeStyle:"short"}).format(n)},E=function(e){for(var t,n=[],r=1;r<=3;r++)t=1===r?e.replace(".png",".png ".concat(r,"x")):e.replace(".png","@".concat(r,"x.png ").concat(r,"x")),n.push(t);return n},O=function(e){var t=e.day||e.night,n=e.dow,r=t.uv_desc,a=function(e){switch(e){case 0:case 1:case 2:return"low";case 3:case 4:case 5:return"moderate";case 6:case 7:case 8:return"high";case 9:case 10:return"very-high";case 11:default:return"extreme"}}(t.uv_index),o=_(t.uv_index,a),i="https://cdn-assets.alltrails.com/assets/icons/cuttlefish-weather/uv/icons-uv-".concat(a,".png");return{topText:n,bottomText:r,imgSrc:i,imgSrcSet:E(i),overlay:o}};function w(e){return(w="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(){return(T=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function S(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){j(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function R(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=k(e);if(t){var a=k(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return N(this,n)}}function N(e,t){return!t||"object"!==w(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function k(e){return(k=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var M=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(i,e);var t,n,r,o=A(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleApiSuccess=function(e){t.parseForecastData(e.forecasts)},t.handleApiError=function(e){console.log(e.responseJSON.errors)},t.handleTabChange=function(e,n){e.preventDefault(),n!==t.state.activeIndex&&t.setState({activeIndex:n})},t.state={activeIndex:0,tabs:e.tabs,loading:!0},t}return t=i,(n=[{key:"componentDidMount",value:function(){this.props.weatherForecast?this.parseForecastData(this.props.weatherForecast.forecasts):this.fetchForecastData()}},{key:"getNewTabState",value:function(e,t,n){return this.state.tabs.map((function(r){switch(r.key){case i.WEATHER_KEY:return C(C({},r),{},{days:e});case i.UV_INDEX_KEY:return C(C({},r),{},{days:t});case i.DAYLIGHT_KEY:return C(C({},r),{},{days:n});default:return r}}))}},{key:"activeTabIsDaylight",value:function(){return this.state.tabs[this.state.activeIndex].key===i.DAYLIGHT_KEY}},{key:"fetchForecastData",value:function(){var e=this.props.locale?{"X-Language-Locale":this.props.locale}:{},t=this.props,n={latitude:t.latitude,longitude:t.longitude,metric:t.metric};h.a.postApiEndpoint(i.FIVE_DAY_FORCAST_URL,n,this.handleApiSuccess,this.handleApiError,(function(){}),e)}},{key:"parseForecastData",value:function(e){var t,n,r,a,o,i,s,l,c,u,d,p,m,f,g,b,h,_=e.slice(0,5),w=(t=this.props.locale,n=_[0],r=v(t,n.sunrise),a=v(t,n.sunset),i="https://cdn-assets.alltrails.com/assets/icons/cuttlefish-weather/sun/icons-daytime-sunset.png",s=E(o="https://cdn-assets.alltrails.com/assets/icons/cuttlefish-weather/sun/icons-daytime-sunrise.png"),l=E(i),[{topText:y.b.strings.SUNRISE,bottomText:r,imgSrc:o,srcSet:s},{topText:y.b.strings.SUNSET,bottomText:a,imgSrc:i,srcSet:l}]),T=[],I=[],x=S(_);try{for(x.s();!(c=x.n()).done;){var C=c.value;T.push((u=C,d=this.props.metric,p=void 0,m=void 0,f=void 0,g=void 0,b=void 0,h=void 0,m=u.day||u.night,f=1==(p=m.icon_code).length?"0".concat(p):"".concat(p),g="https://cdn-assets.alltrails.com/assets/icons/cuttlefish-weather/conditions/icons-weather-icon-weather-".concat(f,".png"),b=E(g),h=d?"C":"F",{topText:u.dow,bottomText:function(e,t,n){return e&&t?"".concat(e,"\xb0"," / ").concat(t,"\xb0"," ").concat(n," "):t?"".concat(t,"\xb0"," ").concat(n):""}(u.max_temp,u.min_temp,h),imgSrc:g,srcSet:b})),I.push(O(C))}}catch(R){x.e(R)}finally{x.f()}var j=this.getNewTabState(T,I,w);this.setState({tabs:j,loading:!1})}},{key:"renderActiveContent",value:function(){return this.state.loading?a.a.createElement("div",{className:b.a.loadingSpinnerContainer},a.a.createElement(l.a,null)):this.state.tabs[this.state.activeIndex].days.map((function(e,t){return a.a.createElement(f,T({key:t},e))}))}},{key:"renderSlidingTabs",value:function(){return a.a.createElement(s.a,{onChange:this.handleTabChange,activeIndex:this.state.activeIndex,slidingTabsClasses:{root:b.a.root},tabs:this.props.tabs})}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderSlidingTabs(),a.a.createElement("ul",{className:"".concat(b.a.list," ").concat(this.activeTabIsDaylight()&&b.a.activeDayLight)},this.renderActiveContent()))}}])&&R(t.prototype,n),r&&R(t,r),i}(r.Component);M.FIVE_DAY_FORCAST_URL="/api/alltrails/weather/5-day-forecast",M.WEATHER_KEY="weather",M.UV_INDEX_KEY="uv_index",M.DAYLIGHT_KEY="day_light",M.propTypes={latitude:i.a.number.isRequired,longitude:i.a.number.isRequired,locale:i.a.string.isRequired,metric:i.a.bool.isRequired,tabs:i.a.arrayOf(i.a.shape({key:i.a.string,label:i.a.string,days:i.a.arrayOf(i.a.shape({topText:i.a.string,bottomText:i.a.string,imgSrc:i.a.string,srcSet:i.a.arrayOf(i.a.string),overlay:i.a.element}))})).isRequired};var D=M},929:function(e,t,n){e.exports={container:"styles-module__container___3rdBs",image:"styles-module__image___1JcWj"}},930:function(e,t,n){e.exports={container:"styles-module__container___2l8jG",image:"styles-module__image___1ZcCy"}},931:function(e,t,n){e.exports={container:"styles-module__container___Pzpd3",text:"styles-module__text___1SK-I"}},956:function(e,t,n){"use strict";var r=n(0),a=n.n(r),o=n(80),i=n(1),s=n.n(i),l=n(51),c=n(290),u=n(24),d=n.n(u),p=n(448),m=n.n(p),f=n(356),g=n(297),b=n(357),h=n(111),y=n(305),_=n(68),v=n(25),E=n(131),O=n(134),w=n(79),T=n(38),S=n(26);function I(e){return(I="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(){return(x=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function R(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=A(e);if(t){var a=A(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return P(this,n)}}function P(e,t){return!t||"object"!==I(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var N=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(i,e);var t,n,r,o=R(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).openLightbox=function(){if(Object(v.g)()){var e=t.getLightboxProps(),n=new CustomEvent("toggleModal",{detail:e});window.parent.document.dispatchEvent(n)}else t.setState({lightboxOpen:!0})},t.handleCloseRequest=function(){t.setState({lightboxOpen:!1})},t.onClick=function(){t.openLightbox()},t.handleFavoriteHeartClick=function(e,n){Object(v.g)()?t.props.messagingChannel.publish("listModal.open",{type:e,objectId:n}):t.props.listMethods.handleFavoriteClick(e,n)},t.state={lightboxOpen:!1},t}return t=i,(n=[{key:"getLightboxProps",value:function(){return{images:Object(w.e)(this.props.photos),handleCloseRequest:this.handleCloseRequest,isOpen:!0,startingIndex:0,trailId:this.props.trail.trailId}}},{key:"renderLightbox",value:function(){return this.state.lightboxOpen?a.a.createElement(O.default,this.getLightboxProps()):null}},{key:"render",value:function(){var e=this,t=this.props,n=t.context,r=t.listMethods,o=t.trail,i=t.photoUrl,s=t.photos,l=t.isPending,c=i||Object(v.f)(o),u=o.name;return l&&(u+=" [PENDING]"),a.a.createElement("div",x({className:["xlate-none",m.a.card,s.length>0?m.a.clickable:""].join(" "),itemProp:"image",content:c,title:o.name},s.length>0?{onClick:this.onClick,role:"button"}:{}),c&&a.a.createElement("img",{src:c,alt:o.name,className:m.a.backgroundImage}),a.a.createElement("div",{className:m.a.content},a.a.createElement("h1",{className:["xlate-none",m.a.name].join(" "),itemProp:"name",title:o.name},u),a.a.createElement("div",{className:"".concat(d.a.info," ").concat(d.a.thin)},a.a.createElement(b.a,{difficulty:o.difficulty_rating}),a.a.createElement("span",{className:m.a.starRatingWrapper,itemProp:"aggregateRating",itemScope:!0,itemType:"http://schema.org/AggregateRating"},a.a.createElement(_.a,{config:o.avg_rating}),a.a.createElement("meta",{itemProp:"ratingValue",content:null==o.avg_rating?"0":o.avg_rating}),a.a.createElement("meta",{itemProp:"worstRating",content:"0"}),a.a.createElement("meta",{itemProp:"bestRating",content:"5"}),a.a.createElement("meta",{itemProp:"reviewCount",content:o.num_reviews})),a.a.createElement(y.a,{className:m.a.reviewCount,count:o.num_reviews})),a.a.createElement(f.a,{className:m.a.location,context:this.props.context,trail:o})),a.a.createElement(g.a,{className:m.a.badge,isCompleted:r.isComplete(o.type,o.ID),isVerified:r.isVerified(o.type,o.ID)}),a.a.createElement(h.a,{className:m.a.favorite,handleFavoriteClick:function(){Object(T.a)().logEvent(S.A,{"trail id":o.trail_id}),Object(E.c)(e.props.messagingChannel,"trail_save",n.currentUser,(function(){e.handleFavoriteHeartClick(o.type,o.ID)}))},isFavorite:r.isFavorite(o.type,o.ID)}),this.renderLightbox())}}])&&C(t.prototype,n),r&&C(t,r),i}(r.Component);N.propTypes={exploreFlag:i.bool,isCompleted:i.bool,isPending:i.bool,isFavorite:i.bool,isVerified:i.bool,numPhotos:i.number,photoUrl:i.string,context:l.e,trail:c.a,photos:Object(i.arrayOf)(Object(i.shape)({id:i.number,photoHash:i.string})),listMethods:Object(i.shape)({isComplete:i.func,isVerified:i.func,isFavorite:i.func,handleFavoriteClick:i.func}).isRequired},N.defaultProps={exploreFlag:!1,isCompleted:!1,isPending:!1,isFavorite:!1,isVerified:!1,numPhotos:0,photoUrl:null,context:{},trail:{},photos:[]};var k=N,M=n(538),D=n(258),L=n(382),B=n(23),U=n.n(B),F=n(162),W=n(6),H=n(2),G=n(743),K=n.n(G),q=n(49),z=n(121),V=n(137);function Y(e){return(Y="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function J(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function X(e,t){return(X=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Z(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Q(e);if(t){var a=Q(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return $(this,n)}}function $(e,t){return!t||"object"!==Y(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Q(e){return(Q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var ee=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&X(e,t)}(i,e);var t,n,r,o=Z(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleChange=function(e){e.preventDefault(),t.props.submitting||t.setState({text:e.currentTarget.value})},t.handleSubmit=function(e){e.preventDefault(),t.props.submitting||t.props.handleSubmit(t.state.text)},t.renderFormButtons=function(){return a.a.createElement("div",{className:K.a.buttonContainer},a.a.createElement(z.a,{value:H.b.strings.SUBMIT,disabled:t.props.submitting,className:"".concat(K.a.formButton)}),a.a.createElement(V.a,{text:H.b.strings.CANCEL,handler:t.props.handleCancelPress,variant:"text"}))},t.state={text:e.text},t}return t=i,(n=[{key:"render",value:function(){return a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement(q.a,{name:"description",errorMessage:"",value:this.state.text,label:this.props.label,changeHandler:this.handleChange,multiline:!0,verticalResize:!0,rows:8}),this.renderFormButtons())}}])&&J(t.prototype,n),r&&J(t,r),i}(r.Component);ee.propTypes={maxLength:s.a.number,text:s.a.string,handleCancelPress:s.a.func,handleSubmit:s.a.func,errorMessage:s.a.string,submitting:s.a.bool,label:s.a.string};var te=ee,ne=n(1026),re=n.n(ne),ae=n(39);function oe(e){return(oe="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e){return function(e){if(Array.isArray(e))return se(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return se(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function le(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ue(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe(e);if(t){var a=pe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return de(this,n)}}function de(e,t){return!t||"object"!==oe(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function pe(e){return(pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var me=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(i,e);var t,n,r,o=ue(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).addItem=function(){if(!t.props.submitting){var e=[].concat(ie(t.state.items),[{id:null,content:""}]);t.setState({items:e})}},t.deleteItem=function(e){if(!t.props.submitting){var n=t.state.items;n[e].deleted=!0,t.setState({items:n})}},t.handleChange=function(e,n){if(e.preventDefault(),!t.props.submitting){var r=t.state.items;r[n].content=e.currentTarget.value,t.setState({items:r})}},t.handleSubmit=function(e){e.preventDefault(),t.props.submitting||t.props.handleSubmit(t.state.items)},t.renderRows=function(){return t.state.items.map((function(e,n){return!e.deleted&&a.a.createElement("tr",{key:n},a.a.createElement("td",null,a.a.createElement(q.a,{value:e.content,changeHandler:function(e){return t.handleChange(e,n)},multiline:!0,verticalResize:!0,rows:3})),a.a.createElement("td",null,a.a.createElement(ae.a,{onClick:function(){return t.deleteItem(n)},variant:"secondary"},"Delete")))}))},t.renderFormButtons=function(){return a.a.createElement("div",{className:K.a.buttonContainer},a.a.createElement(z.a,{value:H.b.strings.SUBMIT,disabled:t.props.submitting,className:"".concat(K.a.formButton)}),a.a.createElement(V.a,{text:H.b.strings.CANCEL,handler:t.props.handleCancelPress,variant:"text"}))},t.state={items:e.items},t}return t=i,(n=[{key:"render",value:function(){var e=this.renderRows();return a.a.createElement("form",{onSubmit:this.handleSubmit},a.a.createElement("table",{className:re.a.itemTable},a.a.createElement("tbody",null,e,a.a.createElement("tr",null,a.a.createElement("td",null,a.a.createElement(ae.a,{onClick:this.addItem,variant:"secondary"},"Add"))))),this.renderFormButtons(),this.props.errorMessage&&a.a.createElement("p",null,this.props.errorMessage))}}])&&le(t.prototype,n),r&&le(t,r),i}(r.Component);me.propTypes={items:s.a.arrayOf(s.a.shape({id:s.a.number.isRequired,content:s.a.string})),handleCancelPress:s.a.func,handleSubmit:s.a.func,errorMessage:s.a.string,submitting:s.a.bool};var fe=me,ge=n(346),be=n.n(ge);function he(e){return(he="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _e(e,t){return(_e=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function ve(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Oe(e);if(t){var a=Oe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ee(this,n)}}function Ee(e,t){return!t||"object"!==he(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Oe(e){return(Oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var we=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_e(e,t)}(i,e);var t,n,r,o=ve(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).toggleShowInTranslatedLang=function(){var e=t.state.showInTranslatedLang;t.setState({showInTranslatedLang:!e})},t.toggleShowMore=function(){_gaq.push(["_trackEvent","Trail SEO",t.props.editItem.key,"Show More"]),t.setState({truncated:!1})},t.submitError=function(){t.setState({submitErrorMessage:H.b.strings.TRACK_DETAIL.CANNOT_SAVE_UPDATE,submitting:!1})},t.submitSuccess=function(e,n){var r=t.state.currentEditItemKey,a=t.state[r];Object.assign(a,{value:n,sourceText:n});var o={currentEditItemKey:!1,submitting:!1,submitErrorMessage:""};o[r]=a,t.setState(o)},t.alertSubmitSuccess=function(e){var n=t.state.editItem;Object.assign(n,{items:e}),t.setState({currentEditItemKey:!1,submitting:!1,submitErrorMessage:"",editItem:n})},t.submitPendingEditItemComplete=function(){t.setState({currentEditItemKey:!1,submitting:!1,submittedPendingEditItem:!0})},t.adminOrPendingOwnerCallback=function(e,n){W.a.getApiEndpoint("/api/alltrails/edits/apply",{type:"trail",target_object_id:t.props.trailId},(function(e){return t.submitSuccess(e,n)}),t.submitError,(function(){}))},t.postItemCallback=function(e,n){var r="/api/alltrails/edits/groups/".concat(e.editGroups[0].id,"/items"),a=t.state[t.state.currentEditItemKey];t.props.adminOrPendingOwner?W.a.postApiEndpoint(r,{type:"trail_detail",data:{name:a.key,value:n}},(function(e){return t.adminOrPendingOwnerCallback(e,n)}),t.submitError,(function(){})):W.a.postApiEndpoint(r,{type:"trail_detail",data:{name:a.key,value:n}},t.submitPendingEditItemComplete,t.submitError,(function(){}))},t.submit=function(e){t.setState({submitting:!0,submitErrorMessage:""});W.a.postApiEndpoint("/api/alltrails/edits/groups",{type:"trail",target_object_id:t.props.trailId},(function(n){return t.postItemCallback(n,e)}),t.submitError,(function(){}))},t.openEditForm=function(e){t.setState({currentEditItemKey:e})},t.submitAlerts=function(e){t.setState({submitting:!0,submitErrorMessage:""});W.a.postApiEndpoint("/api/alltrails/admin/alerts",{type:"trail",id:t.props.trailId,alerts:e},(function(e){return t.alertSubmitSuccess(e)}),t.submitError,(function(){}))},t.closeEditForm=function(){t.setState({currentEditItemKey:!1})},t.state={currentEditItemKey:!1,submitting:!1,submittedPendingEditItem:!1,showMoreButton:!1,truncated:!0,showInTranslatedLang:!1,submitErrorMessage:"",editItem:e.editItem,seoDescriptionEditItem:e.editItem.seoDescription},t}return t=i,(n=[{key:"componentDidMount",value:function(){this.checkToShowMoreBtn()}},{key:"componentDidUpdate",value:function(){this.checkToShowMoreBtn()}},{key:"checkToShowMoreBtn",value:function(){var e=this,t=this.props,n=t.visible,r=t.editItem,a=this.state.showMoreButton;n&&r&&!a&&window&&window.setTimeout((function(){window.elementHasOverflow("text-container-".concat(e.props.editItem.key))&&e.setState({showMoreButton:!0})}),10)}},{key:"componentWillReceiveProps",value:function(e){this.state.currentEditItemKey&&e.editItem.key!=this.props.editItem.key&&this.closeEditForm()}},{key:"getEditCta",value:function(e){switch(e){case"editItem":return this.props.adminOrPendingOwner?H.b.strings.EDIT_DESCRIPTION:H.b.strings.SUGGEST_EDIT;case"seoDescriptionEditItem":return H.b.strings.EDIT_SEO_DESCRIPTION;default:return null}}},{key:"noEditCta",value:function(){return!this.props.loggedInUser||(this.props.adminOrPendingOwner?!!this.state.editItem.unsupportedLanguage:this.state.editItem.key!==i.DESCRIPTION)}},{key:"getDisplayText",value:function(e){var t;return!this.state.showInTranslatedLang&&e.sourceText?t=e.sourceText:e.value?t=e.value:"alerts"===e.key&&(t=this.props.adminOrPendingOwner?e.items.map((function(e){return"\u2022 ".concat(e.content).concat("AreaAlert"===e.type?" [PARK]".concat("C"===e.alertType?" [CLOSURE]":""):"")})).join("\n"):e.items.map((function(e){return"\u2022 ".concat(e.content)})).join("\n")),t}},{key:"renderDisplayText",value:function(){return this.getDisplayText(this.state.editItem)}},{key:"renderButton",value:function(e,t){return a.a.createElement("button",{className:be.a.editButton,type:"button",onClick:t},e)}},{key:"renderEditCTA",value:function(){var e=this;if(!this.noEditCta()){if(this.state.submittedPendingEditItem)return a.a.createElement("span",null,H.b.strings.THANK_YOU);var t=this.getEditCta("editItem");return this.renderButton(t,(function(){e.openEditForm("editItem")}))}}},{key:"hasSeoDescription",value:function(){var e=this.state.seoDescriptionEditItem;return e&&(this.getDisplayText(e)||"").length>0}},{key:"renderSeoDescription",value:function(){if(this.hasSeoDescription()){var e=(this.getDisplayText(this.state.seoDescriptionEditItem)||"").replace(/(\r\n|\n|\r)/gm,"");return a.a.createElement("div",{className:U()(be.a.displayText,be.a.extendedDescription),dangerouslySetInnerHTML:{__html:e}})}}},{key:"renderSeoDescriptionEditCTA",value:function(){var e=this;if(this.state.seoDescriptionEditItem&&this.props.adminUser){var t=H.b.strings.EDIT_SEO_DESCRIPTION;return a.a.createElement("p",{className:be.a.editSeoDescriptionCTA},this.renderButton(t,(function(){e.openEditForm("seoDescriptionEditItem")})))}}},{key:"renderShowOrigLangBtn",value:function(){return this.state.editItem.sourceText&&this.state.editItem.sourceText!==this.state.editItem.value?a.a.createElement("div",{className:be.a.languageContainer},a.a.createElement(F.a,{active:this.state.showInTranslatedLang,handleClick:this.toggleShowInTranslatedLang,eventSource:"TrailDetail ".concat(this.state.editItem.key)})):null}},{key:"renderShowMoreButton",value:function(){return this.state.showMoreButton&&this.state.truncated?a.a.createElement("button",{className:be.a.showMoreBtn,type:"button",onClick:this.toggleShowMore},H.b.strings.SHOW_MORE):null}},{key:"renderEditForm",value:function(){var e=this.state[this.state.currentEditItemKey];return a.a.createElement(te,{maxLength:e.maxLength,text:e.sourceText?e.sourceText:e.value,handleCancelPress:this.closeEditForm,handleSubmit:this.submit,errorMessage:this.state.submitErrorMessage,submitting:this.state.submitting,label:this.getEditCta(this.state.currentEditItemKey)})}},{key:"renderAlertsList",value:function(){this.getEditCta();var e=this.state.editItem.items.filter((function(e){return"TrailAlert"==e.type})),t=this.state.submitErrorMessage||"Trail-level alerts edited here. Use Bulk Trail Edit for park-level alerts.";return a.a.createElement(fe,{items:e,handleCancelPress:this.closeEditForm,handleSubmit:this.submitAlerts,errorMessage:t,submitting:this.state.submitting})}},{key:"renderContentOrForm",value:function(){return this.state.currentEditItemKey?"alerts"===this.state.editItem.key?this.renderAlertsList():this.renderEditForm():a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:be.a.textAndBtnContainer},a.a.createElement("div",{id:"text-container-".concat(this.props.editItem.key),className:"".concat(be.a.displayText," ").concat(this.state.truncated&&!this.hasSeoDescription()?"".concat(be.a.lineClamp):"")},a.a.createElement(L.a,{target:"_blank",rel:"noreferrer noopener"},this.renderDisplayText())),this.renderShowMoreButton()),this.renderSeoDescription(),a.a.createElement("div",{className:"".concat(be.a.buttonContainer," ").concat(this.noEditCta()&&this.state.showMoreButton?"".concat(be.a.rowReverse):"")},this.renderEditCTA(),this.renderSeoDescriptionEditCTA()),this.renderShowOrigLangBtn())}},{key:"render",value:function(){return a.a.createElement("div",{className:"".concat(be.a.trailDetailItemContainer," ").concat(this.props.visible?"":"".concat(be.a.hidden))},this.renderContentOrForm())}}])&&ye(t.prototype,n),r&&ye(t,r),i}(r.Component);we.DESCRIPTION="description",we.propTypes={trailId:s.a.number.isRequired,editItem:s.a.shape({key:s.a.string.isRequired}).isRequired,adminOrPendingOwner:s.a.bool,adminuser:s.a.bool,loggedInUser:s.a.bool,visible:s.a.bool},we.defaultProps={adminOrPendingOwner:!1,adminUser:!1,loggedInUser:null,visible:!1};var Te=we,Se=n(739);function Ie(e){return(Ie="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function xe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Ce(e,t){return(Ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function je(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Pe(e);if(t){var a=Pe(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Re(this,n)}}function Re(e,t){return!t||"object"!==Ie(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Pe(e){return(Pe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Ae=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ce(e,t)}(i,e);var t,n,r,o=je(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleTabChange=function(e,n){e.preventDefault(),n!==t.state.activeIndex&&t.setState({activeIndex:n})},t.state={activeIndex:0,messagingChannel:null},t}return t=i,(n=[{key:"componentDidMount",value:function(){Object(v.g)()&&window.parent&&window.parent.messagingTunnel&&this.setState({messagingChannel:window.parent.messagingTunnel("explore_messagingChannel")})}},{key:"getTabs",value:function(){return this.props.tabs.map((function(e){return{label:e.label}}))}},{key:"renderSlidingTabs",value:function(){return a.a.createElement(D.a,{onChange:this.handleTabChange,activeIndex:this.state.activeIndex,tabs:this.getTabs()})}},{key:"renderOverviewContent",value:function(){var e=this;return this.props.tabs.map((function(t,n){var r=e.state.activeIndex===n;return"waypoints"===t.key?a.a.createElement("div",{className:r?"":"hidden",key:t.key},a.a.createElement(Se.a,{canEdit:e.props.context.adminOrPendingOwner,waypoints:t.value.waypoints,mapId:t.value.id,trailId:e.props.trailId,messagingChannel:e.state.messagingChannel,isAdmin:e.props.context.adminUser})):a.a.createElement(Te,{key:t.key,trailId:e.props.trailId,editItem:t,adminOrPendingOwner:e.props.context.adminOrPendingOwner,adminUser:e.props.context.adminUser,loggedInUser:e.props.context.loggedInUser,visible:r})}))}},{key:"render",value:function(){return a.a.createElement("div",{className:H.b.constants.XLATE.NONE},this.renderSlidingTabs(),this.renderOverviewContent())}}])&&xe(t.prototype,n),r&&xe(t,r),i}(r.Component);Ae.propTypes={context:s.a.shape({adminOrPendingUser:s.a.bool,adminUser:s.a.bool,loggedInUser:s.a.bool,mobileBrowser:s.a.bool,proUser:s.a.bool,tabletBrowser:s.a.bool,displayMetric:s.a.bool,locale:s.a.string}).isRequired,trailId:s.a.number.isRequired,tabs:s.a.arrayOf(s.a.shape({label:s.a.string,key:s.a.string,value:s.a.oneOfType([s.a.string,s.a.object]),sourceText:s.a.string,maxLength:s.a.number})).isRequired,adminUser:s.a.bool},Ae.defaultProps={adminUser:null};var Ne=Ae,ke=n(880),Me=n(1092),De=n(592),Le=n.n(De),Be=n(15);function Ue(e){return(Ue="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Fe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function We(e,t){return(We=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function He(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Ke(e);if(t){var a=Ke(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return Ge(this,n)}}function Ge(e,t){return!t||"object"!==Ue(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Ke(e){return(Ke=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var qe=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&We(e,t)}(s,e);var t,n,o,i=He(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).handleMouseEnter=function(){t.setState({dropdownExpanded:!0})},t.handleMouseLeave=function(){t.setState({dropdownExpanded:!1})},t.regenerateSlug=function(){if(window.confirm("Are you sure you want to regenerate this trail's slug?")){var e,n=t.regenerateButton.current;n.innerHTML="Queuing...",(e=t.props.trailId,Object(Be.b)({type:"GET",url:"/api/alltrails/trails/".concat(e,"/regen_slug")})).then((function(){n.innerHTML="Queued for regeneration",n.disabled=!0}))}},t.refreshTrail=function(){if(window.confirm("Are you sure you want to redraw this trail's static map and clear it's cached data?")){var e,n=t.refreshButton.current;n.innerHTML="Refreshing...",(e=t.props.trailId,Object(Be.b)({type:"GET",url:"/api/alltrails/trails/".concat(e,"/refresh_trail_cache")})).then((function(){n.innerHTML="Refreshed",n.disabled=!0}))}},t.mergeEnds=function(){if(window.confirm("Are you sure you want to merge the ends of this trail's route?")){var e,n=t.offerMergeEndsButton.current;n.innerHTML="Merging...",(e=t.props.trailId,Object(Be.b)({type:"GET",url:"/api/alltrails/trails/".concat(e,"/merge_trail_ends")})).then((function(){n.innerHTML="Ends merged",window.location.reload()}))}},t.reclusterRecordings=function(){if(window.confirm("Are you sure you want to rerun verified-compeleted and clustering logic on all recordings attached to this trail?")){var e,n=t.reclusterButton.current;n.innerHTML="Reclustering...",(e=t.props.trailId,Object(Be.b)({type:"GET",url:"/api/alltrails/trails/".concat(e,"/recluster_recordings")})).then((function(){n.innerHTML="Queued for reclustering",n.disabled=!0}))}},t.regenerateButton=Object(r.createRef)(),t.refreshButton=Object(r.createRef)(),t.offerMergeEndsButton=Object(r.createRef)(),t.reclusterButton=Object(r.createRef)(),t.state={dropdownExpanded:!1},t}return t=s,(n=[{key:"renderDropdown",value:function(){return a.a.createElement("div",{onMouseLeave:this.handleMouseLeave,className:Le.a.dropdownContainer},a.a.createElement("button",{ref:this.regenerateButton,className:Le.a.dropdownButton,type:"button",key:"regenerate-slug",onClick:this.regenerateSlug},"Regenerate Slug"),a.a.createElement("button",{ref:this.refreshButton,className:Le.a.dropdownButton,type:"button",key:"refresh-trail",onClick:this.refreshTrail},"Refresh Trail"),a.a.createElement("a",{className:Le.a.dropdownButton,href:"/edit-translations?id=".concat(this.props.trailId,"&table=trails&column_name=name"),key:"edit-translations",target:"_blank",rel:"noopener noreferrer"},"Edit Translations"),this.props.offerMergeEnds&&a.a.createElement("button",{ref:this.offerMergeEndsButton,className:Le.a.dropdownButton,type:"button",onClick:this.mergeEnds},"Merge Ends"),this.props.statusPending&&a.a.createElement("button",{ref:this.reclusterButton,className:Le.a.dropdownButton,type:"button",onClick:this.reclusterRecordings},"Recluster Recordings"))}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("button",{onMouseEnter:this.handleMouseEnter,className:Le.a.triggerContainer,type:"button"},a.a.createElement(Me.a,null)),this.state.dropdownExpanded&&this.renderDropdown())}}])&&Fe(t.prototype,n),o&&Fe(t,o),s}(r.Component);qe.propTypes={offerMergeEnds:s.a.bool,trailId:s.a.number,statusPending:s.a.bool},qe.defaultProps={offerMergeEnds:null,trailId:null,statusPending:!1};var ze=qe,Ve=n(595),Ye=n(929),Je=n.n(Ye),Xe=n.p+"media/components/shared/pro_awareness/SmallHouse/small_house-936dcb64cfaf0bccfb66a5468b0d1e83.png",Ze=n(451),$e=function(){return a.a.createElement(Ze.a,{variation:"small_house"},a.a.createElement("div",{className:Je.a.container},a.a.createElement("img",{className:Je.a.image,src:Xe,alt:"Get Pro. Use maps offline."})))},Qe=n(930),et=n.n(Qe),tt=n.p+"media/components/shared/pro_awareness/LargeHouse/large_house-d581f533b8387fafbbdd320669dbaf27.png",nt=function(){return a.a.createElement(Ze.a,{variation:"large_house"},a.a.createElement("div",{className:et.a.container},a.a.createElement("img",{className:et.a.image,src:tt,alt:"Get Pro. Use maps offline."})))},rt=n(746),at=n(332),ot=n(806),it=n.n(ot),st=n(304),lt=n(8);function ct(e){return(ct="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ut(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function dt(e,t){return(dt=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function pt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=ft(e);if(t){var a=ft(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return mt(this,n)}}function mt(e,t){return!t||"object"!==ct(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ft(e){return(ft=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var gt=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dt(e,t)}(i,e);var t,n,r,o=pt(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=o.call(this,e)).handleClick=function(e){if(e.preventDefault(),t.props.adminUser&&t.props.trailId)return t.openAdminLink();if(!t.props.slug||Object(v.g)())t.openLightbox(0);else{var n=lt.a.wrapUrlSafe("/".concat(t.props.slug,"/photos"),t.props.locale);window.location.href=n}},t.state={lightboxOpen:!1,startingPhotosIndex:0},t}return t=i,(n=[{key:"handleCloseRequest",value:function(){this.setState({lightboxOpen:!1,startingPhotosIndex:null})}},{key:"openAdminLink",value:function(){var e="/contribute/admin/photos?trail_id=".concat(this.props.trailId);window.open(e,"_blank")}},{key:"openLightbox",value:function(e){if(Object(v.g)()){var t=this.getLightboxProps(this.state.startingPhotosIndex),n=new CustomEvent("toggleModal",{detail:t});window.parent.document.dispatchEvent(n)}else this.setState({lightboxOpen:!0,startingPhotosIndex:e})}},{key:"getLightboxProps",value:function(e){return{images:Object(w.e)(this.props.photos),handleCloseRequest:this.handleCloseRequest,isOpen:!0,startingIndex:e,trailId:this.props.trailId}}},{key:"renderLightbox",value:function(){if(this.state.lightboxOpen)return a.a.createElement(O.default,this.getLightboxProps(this.state.startingPhotoIndex))}},{key:"render",value:function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement(st.a,{href:lt.a.wrapUrlSafe("/".concat(this.props.slug,"/photos"),this.props.locale),onClick:this.handleClick,icon:"photo",title:H.b.strings.TAB_NAMES.PHOTOS,count:this.props.count,languageRegionCode:this.props.languageRegionCode}),this.renderLightbox())}}])&&ut(t.prototype,n),r&&ut(t,r),i}(r.Component);gt.defaultProps={locale:"",adminUser:!1,trailId:0,slug:"",count:0},gt.propTypes={locale:s.a.string,adminUser:s.a.bool,trailId:s.a.number,slug:s.a.string,count:s.a.number,languageRegionCode:s.a.string};var bt=gt,ht=n(43),yt=n.n(ht),_t=yt.a.channel("explore_messagingChannel"),vt=function(e){var t=e.currentUser,n=e.event,o=e.mobileBrowser,i=e.disabled,s=e.atRef,l=e.geoloc,c="https://www.google.com/maps/dir/Current+Location/".concat(l.lat,",").concat(l.lng),u=function(){Object(E.c)(_t,n,t,c,{atRef:s,returnToUrl:c,openInNewTab:!0})},d=Object(r.useMemo)((function(){var e={icon:"directions",title:H.b.strings.TRACK_DETAIL.DIRECTIONS};return!i&&l.lat&&l.lng?o?t?Object.assign(e,{onClick:u}):Object.assign(e,{href:Object(E.b)(c,s)}):Object.assign(e,{href:c,target:"_blank"}):Object.assign(e,{disabled:i})}),[]);return a.a.createElement(st.a,d)};vt.propTypes={currentUser:i.object,event:i.string,mobileBrowser:i.bool,geoloc:Object(i.shape)({lat:i.number,lng:i.number}),atRef:i.string,disabled:i.bool},vt.defaultProps={geoloc:{lat:null,lng:null},currentUser:null,event:"",mobileBrowser:!1,atRef:"",disabled:!1};var Et=vt,Ot=n(14),wt=n.n(Ot),Tt=n(372),St=n.n(Tt),It=n(150),xt=n(401),Ct=n(322),jt=n(400),Rt=n(515),Pt=n(749),At=s.a.shape({publish:s.a.func.isRequired,subscribe:s.a.func.isRequired}),Nt=n(60),kt=n(40),Mt=n(16),Dt=n(54),Lt=n(62);function Bt(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,a=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(l){a=!0,o=l}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}return n}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return Ut(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ut(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ut(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ft(e){var t=e.currentUser,n=e.exploreFlag,o=e.isMobileWidth,i=e.messagingChannel,s=e.mobileBrowser,l=e.pending,c=e.printUrl,u=e.trail,d=Bt(Object(r.useState)(!1),2),p=d[0],m=d[1],f=Bt(Object(r.useState)(),2),g=f[0],b=f[1],h=Bt(Object(r.useState)(),2),y=h[0],_=h[1],v=Object(r.useContext)(It.c);function E(e){_(e)}function O(e){return E("error"),Object(kt.a)(e),e}function w(e){window.top.location.href=Object(Lt.a)("/explore/map/".concat(e.slug,"?save"))}var I=null;if(!l&&!s)if(t){var x=n||o?i:null;I=a.a.createElement(Rt.a,{useMessagingChannel:x,trailSlug:u.slug,styles:St.a})}else{var C=W.a.signupPath("trail-action-menu-gpx");I=a.a.createElement("div",{className:St.a.dropdownItem},a.a.createElement("a",{className:St.a.gpxLabel,href:C,onClick:function(){return Object(T.a)().logEvent(S.B,{"trail id":u.trail_id},(function(){var e=window.location.pathname+window.location.search;Object(Nt.b)("trail-more-gpx",e)})),!1},title:H.b.strings.TRACK_DETAIL.DOWNLOAD_ROUTE},H.b.strings.TRACK_DETAIL.DOWNLOAD_ROUTE))}var j=a.a.createElement("div",{className:St.a.dropdownItem},a.a.createElement("a",{key:"customizeMap",onClick:Object(Mt.a)((function(){if(!t)return e=window.location.pathname+window.location.search,void Object(Nt.b)("explore-map-new",e);var e,n=u.trail_id,r=u.name;E("saving"),Object(Dt.c)(n,r).then(w).catch(O)}))},H.b.strings.CUSTOMIZE_MAP)),R=null,P=null;(n||o)&&(R=a.a.createElement("div",{className:St.a.dropdownItem},a.a.createElement("a",{onClick:function(){var e={id:u.trail_id,name:u.name,slug:u.slug,type:"trail",primaryKey:"trail_id"};return n?i.publish({topic:"shareModal.open",data:{shareObject:e}}):(m(!0),b(e),document.querySelector(".hide-for-fullscreen-modal").style.display="none"),!0},"data-testid":"trail_more_alternate_share"},H.b.strings.SHARE," ")),s||(P=a.a.createElement("div",{className:St.a.dropdownItem},a.a.createElement("a",{className:St.a.gpxLabel,target:"_blank",href:c},H.b.strings.PRINT_PDF_MAP,a.a.createElement("span",{className:St.a.printItem},a.a.createElement("img",{alt:H.b.strings.PRO.ALLTRAILS_PRO,className:St.a.proBadge,src:Ct.a}))))));var A=null,N=null;if(t){var k=lt.a.wrapUrlSafe("/".concat(u.slug,"/edit?ref=trail-more-edit"),v.globalState.context.languageRegionCode);A=a.a.createElement("div",{className:U()(St.a.dropdownItem,"suggest",!n&&"trail-details")},a.a.createElement("a",{href:k,target:"_blank",onClick:function(){var e=window.location.pathname+window.location.search;return!!t||(Object(Nt.b)("trail-more-edit",e),!1)}},H.b.strings.SUGGEST_EDIT)),t.admin&&(N=a.a.createElement("div",{className:St.a.dropdownItem,onClick:function(){if(window.confirm("Are you sure you want to delete this trail?")){var e="/api/alltrails/trails/".concat(u.trail_id);W.a.deleteApiEndpoint(e,{},(function(){window.location=lt.a.wrapUrlSafe("/explore")}),(function(e,t,n){Object(kt.a)(n)}))}}},a.a.createElement("a",null,"Delete Trail")))}return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{className:St.a.dropdown},A,N,R,I,j,P),Object(jt.a)(p,(function(){m(!1),document.querySelector(".hide-for-fullscreen-modal").style.display=""}),g,t),y?wt.a.createPortal(a.a.createElement(xt.a,{variant:y,updateProgressDialog:E}),document.getElementById("modalPortal")):null)}Ft.propTypes={currentUser:Pt.a,messagingChannel:At.isRequired,trail:c.a.isRequired},Ft.defaultProps={currentUser:null};var Wt=Ft,Ht=n(28)({displayName:"TrailMoreAlternateMenuItem",getInitialState:function(){return{dropDownOpen:!1,modalOpen:!1}},componentDidMount:function(){var e=window&&window.innerWidth<=767;window.addEventListener("resize",this.handleResize),this.setState({isMobileWidth:e})},handleResize:function(){var e=window&&window.innerWidth<=767;this.setState({isMobileWidth:e})},componentWillMount:function(){Object(v.g)()&&("undefined"===typeof parent?this.messagingTunnel&&(this.messagingChannel=this.messagingTunnel("explore_messagingChannel")):parent.messagingTunnel&&(this.messagingChannel=parent.messagingTunnel("explore_messagingChannel"))),this.messagingChannel||(this.messagingChannel=yt.a.channel("explore_messagingChannel"))},modalIsOpen:function(e){this.setState({modalOpen:e})},handleMouseClick:function(e){e.preventDefault(),e.currentTarget.classList.contains("moreAction")&&this.setState({dropDownOpen:!this.state.dropDownOpen})},handleMouseEnter:function(){this.props.mobileBrowser||this.state.modalOpen||this.setState({dropDownOpen:!0})},handleMouseLeave:function(){this.props.mobileBrowser||this.state.modalOpen||this.setState({dropDownOpen:!1})},render:function(){return a.a.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,className:"moreContainer"},a.a.createElement(st.a,{title:H.b.strings.MORE,icon:"more",onClick:this.handleMouseClick,className:"moreAction"}),this.state.dropDownOpen&&a.a.createElement(Wt,{modalIsOpen:this.modalIsOpen,trail:this.props.trail,messagingChannel:this.messagingChannel,pending:this.props.pending,exploreFlag:this.props.exploreFlag,currentUser:this.props.currentUser,printUrl:this.props.printUrl,mobileBrowser:this.props.mobileBrowser,isMobileWidth:this.state.isMobileWidth}))}}),Gt=n(818),Kt=n(750);var qt=function(e){var t=e.context,n=e.currentUser,r=e.photos,o=e.numPhotos,i=e.trail,s=e.pending,l=e.exploreFlag,c=e.shareObject,u=function(e,t){return e&&e.pro?"/".concat(t.slug,"/print"):e?"/pro?ref=trail-action-menu-print":"/signup?ref=trail-action-menu-print"}(n,i);return a.a.createElement("div",{className:it.a.mainActionBar},a.a.createElement("ul",{className:it.a.list},a.a.createElement(bt,{adminUser:t.adminUser,photos:r,count:o,trailId:i.trail_id,slug:i.slug,locale:t.locale,languageRegionCode:t.languageRegionCode}),a.a.createElement(Et,{mobileBrowser:t.mobileBrowser,currentUser:n,disabled:!i._geoloc||!i._geoloc.lat||!i._geoloc.lng,geoloc:i._geoloc,atRef:"trail-action-menu-directions",event:"trail_directions"}),!t.mobileBrowser&&a.a.createElement(st.a,{icon:"print",disabled:s,title:H.b.strings.PRINT_PDF_MAP,className:it.a.mobileHide,onClick:function(){if(!n)return Object(T.a)().logEvent(S.C,{"trail id":i.trail_id},(function(){window.location.assign(u)})),!1;window.location.assign(u)}}),a.a.createElement(Gt.a,{className:it.a.mobileHide,currentUser:n,disabled:s,languageRegionCode:t.languageRegionCode,locale:t.shortLocale,shareObject:c,trail:i}),a.a.createElement(Ht,{mobileBrowser:t.mobile_browser,trail:i,pending:s,currentUser:n,printUrl:u,exploreFlag:l})))};qt.propTypes={exploreFlag:i.bool,pending:i.bool,photos:Object(i.arrayOf)(Object(i.shape)({id:i.number,photoHash:i.string})),numPhotos:i.number,shareObject:Kt.a,trail:c.a},qt.defaultProps={exploreFlag:!1,pending:!1,trail:{},shareObject:{},photos:[],numPhotos:null};var zt=qt,Vt=n(642),Yt=n.n(Vt),Jt=yt.a.channel("explore_messagingChannel"),Xt=function(e){var t=e.event,n=e.currentUser,r=e.initialHref,a=e.atRef,o=e.openInNewTab,i=e.mobileBrowser,s=i&&n,l=o?"_blank":"_self",c=i&&!n?Object(E.b)(r,a):r;return{onClick:s?function(e){e.preventDefault(),Object(E.c)(Jt,t,n,c,{atRef:a,returnToUrl:c,openInNewTab:o})}:function(){},href:c,target:l}},Zt=n(641),$t=n.n(Zt),Qt=n.p+"media/components/shared/pro_awareness/TopMap/pro-df1d23bf9dff8485d551ab1057e48f05.png",en=n.p+"media/components/shared/pro_awareness/TopMap/arrow-562acb65f5a6ef1061022c0e2f3ae30b.png",tn=function(){return a.a.createElement(Ze.a,{variation:"top_map"},a.a.createElement("div",{className:$t.a.container},a.a.createElement("div",{className:$t.a.proImageContainer},a.a.createElement("img",{src:Qt,className:$t.a.proImage,alt:"AllTrails Pro"})),a.a.createElement("span",{className:$t.a.text},"Use maps offline. Get Pro."),a.a.createElement("div",{className:$t.a.arrowImageContainer},a.a.createElement("img",{src:en,className:$t.a.arrowImage,alt:""}))))},nn=n(931),rn=n.n(nn),an=function(){return a.a.createElement(Ze.a,{variation:"mid_map"},a.a.createElement("div",{className:rn.a.container},a.a.createElement("span",{className:rn.a.text},"Use maps offline - Get Pro")))},on=n(10),sn=n(738),ln=H.b.strings,cn=ln.EXPAND_MAP,un=ln.VIEW_FULL_MAP,dn=function(e){var t=e.trail,n=e.href,r=e.staticMapUrl,o=e.lat,i=e.lng,s=e.currentUser,l=e.event,c=e.atRef,u=e.languageRegionCode,d=e.mobileBrowser,p=Xt({event:l,currentUser:s,initialHref:n,atRef:c,openInNewTab:!1,mobileBrowser:d}),m=H.b.strings.X_MAP.replace("{x}",t.name).replace(/\s+/g," ");return a.a.createElement("div",{className:Yt.a.container},a.a.createElement("div",{itemProp:"geo",itemScope:!0,itemType:"http://schema.org/GeoCoordinates"},a.a.createElement("meta",{itemProp:"latitude",content:o,className:"xlate-none"}),a.a.createElement("meta",{itemProp:"longitude",content:i,className:"xlate-none"})),a.a.createElement(tn,null),a.a.createElement(an,null),a.a.createElement("a",{className:Yt.a.link,href:p.href,onClick:function(e){p.onClick(e),d&&!s&&Object(T.a)().logEvent(S.x,{"trail id":t.trail_id})},target:p.target},a.a.createElement("img",{src:r,className:Yt.a.mapImage,alt:m}),a.a.createElement("div",{className:"".concat(Yt.a.viewFullMap," ").concat(u===on.a?Yt.a.germanText:"")},a.a.createElement("p",null,un),a.a.createElement("img",{src:sn.a,className:Yt.a.expandIcon,alt:cn}))))};dn.propTypes={trail:c.a.isRequired,staticMapUrl:i.string.isRequired,href:i.string.isRequired,lat:i.number.isRequired,lng:i.number.isRequired,event:i.string.isRequired,atRef:i.string.isRequired,languageRegionCode:i.string,mobileBrowser:i.bool},dn.defaultProps={languageRegionCode:on.b,mobileBrowser:!1};var pn=dn,mn=n(449),fn=n.n(mn),gn=n(20),bn=function(e){var t=e.trail,n=e.routeType,r=e.displayMetric,o=e.languageRegionCode;return a.a.createElement("section",{className:fn.a.trailStatSection},a.a.createElement("div",null,a.a.createElement("span",{className:fn.a.trailStatIcons},a.a.createElement("span",{className:fn.a.statsLabel},H.b.strings.FILTERS.LENGTH),a.a.createElement("span",{className:fn.a.detailData},gn.a.metersToFormattedUserUnits(t.length,1,r,o))),a.a.createElement("span",{className:fn.a.trailStatIcons},a.a.createElement("span",{className:fn.a.statsLabel},H.b.strings.FILTERS.ELEV_GAIN),a.a.createElement("span",{className:fn.a.detailData},gn.a.elevationFormatted(t.elevation_gain,r,o))),a.a.createElement("span",{className:fn.a.trailStatIcons},a.a.createElement("span",{className:fn.a.statsLabel},H.b.strings.FILTERS.ROUTE_TYPE),a.a.createElement("span",{className:fn.a.detailData},Object(v.h)(n)))))};bn.propTypes={trail:s.a.object.isRequired,routeType:s.a.string,displayMetric:s.a.bool,languageRegionCode:s.a.string},bn.defaultProps={displayMetric:!1,routeType:"",languageRegionCode:on.b};var hn=bn,yn=n(181);function _n(e){return(_n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function vn(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function En(e,t){return(En=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function On(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Tn(e);if(t){var a=Tn(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return wn(this,n)}}function wn(e,t){return!t||"object"!==_n(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function Tn(e){return(Tn=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var Sn=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&En(e,t)}(s,e);var t,n,r,i=On(s);function s(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),(t=i.call(this,e)).handleScroll=function(){t.setState({scrollY:window.scrollY})},t.toggleShowMore=function(){t.setState({showMoreOverviewExpanded:!t.state.showMoreOverviewExpanded})},t.renderTags=function(e){if(!e)return null;var t=Object(v.b)();return e.map((function(e){return a.a.createElement("span",{className:"tag",key:e},a.a.createElement("span",{className:"big rounded active"},Object(v.i)(e,t)))}))},t.state={showMoreOverviewExpanded:!1,showMoreButton:!1,nearbyTrails:[],scrollY:0},t}return t=s,(n=[{key:"componentDidMount",value:function(){var e=this;this.checkToShowMoreBtn(),this.props.context.proUser||this.instantiateAd(),Object(yn.a)(this.props.trail.ID,1,24).then((function(t){e.setState({nearbyTrails:t})})),this.setupScrollListener()}},{key:"componentWillUnmount",value:function(){this.props.exploreFlag||document.removeEventListener("scroll",Object(o.debounce)(this.handleScroll,300))}},{key:"setupScrollListener",value:function(){this.props.exploreFlag||document.addEventListener("scroll",Object(o.debounce)(this.handleScroll,300))}},{key:"instantiateAd",value:function(){var e=this;googletag.cmd.push((function(){googletag.defineSlot("/4689141/alltrails_trail_300x250",["fluid",[300,250],[300,600]],"div-gpt-ad-alltrails_trail_300x250").addService(googletag.pubads());for(var t=Object.keys(e.props.adTargetingHash),n=0;n<t.length;n++)googletag.pubads().setTargeting(t[n],e.props.adTargetingHash[t[n]]);googletag.pubads().enableLazyLoad({fetchMarginPercent:0,renderMarginPercent:0,mobileScaling:0}),googletag.enableServices(),googletag.cmd.push((function(){googletag.display("div-gpt-ad-alltrails_trail_300x250")}))}))}},{key:"checkToShowMoreBtn",value:function(){var e=this;!this.state.showMoreButton&&window&&window.setTimeout((function(){window.elementHasOverflow("auto-overview")&&e.setState({showMoreButton:!0})}),10)}},{key:"renderShowMoreButton",value:function(){return!this.state.showMoreButton||this.state.showMoreOverviewExpanded?null:a.a.createElement("div",{className:"show-more-container"},a.a.createElement("button",{type:"button",onClick:this.toggleShowMore},H.b.strings.SHOW_MORE))}},{key:"renderRobotsTag",value:function(){return this.props.pending?a.a.createElement("meta",{name:"robots",content:"noindex"}):null}},{key:"renderTrailOverview",value:function(){return this.props.overview?a.a.createElement("section",{id:"trail-top-overview-text",itemProp:"description"},a.a.createElement("p",{className:this.state.showMoreOverviewExpanded?"xlate-google":"xlate-google line-clamp-4",id:"auto-overview"},this.props.overview),this.renderShowMoreButton()):null}},{key:"renderTagCloud",value:function(){return a.a.createElement("section",{className:"tag-cloud"},this.renderTags(this.props.trailTags.whoToBring),this.renderTags(this.props.trailTags.whatToDo),this.renderTags(this.props.trailTags.whatToSeeAndObstacles))}},{key:"renderTrailSidebar",value:function(){if(this.props.exploreFlag)return null;var e=null;return this.props.context.adminUser&&(e=a.a.createElement(ze,{offerMergeEnds:this.props.offerMergeEnds,trailId:this.props.trail.trail_id,statusPending:this.props.pending})),a.a.createElement("div",{className:"col-lg-4 col-md-4"},a.a.createElement("aside",{className:"trail-aside"},this.renderStaticMapSidebar(),a.a.createElement("div",{className:"suggest-edit-and-dropdown"},a.a.createElement("a",{href:"/".concat(this.props.trail.slug,"/edit?ref=trail-suggest-edit"),target:"_blank",className:"suggest-edit",rel:"nofollow"},H.b.strings.SUGGEST_EDIT),e),a.a.createElement($e,null),a.a.createElement(nt,null),this.renderNearbyTrails(),this.renderTrailAdSlot()))}},{key:"renderNearbyTrails",value:function(){if(0==this.state.nearbyTrails.length)return null;var e=this.props.currentUser?this.props.currentUser.id:null;return a.a.createElement("div",{id:"sidebar-nearby-trails",className:"sidebar-module"},a.a.createElement("h3",{className:"nearby-trails"},a.a.createElement("a",{href:this.props.explorePath},H.b.strings.OVERLAYS.NEARBY_TRAILS)),a.a.createElement(rt.a,{context:this.props.context,initialPage:"SEO_TRAIL",nearLocation:!1,userId:e,results:this.state.nearbyTrails,currentUser:this.props.currentUser,showAds:this.props.showAds,mobileBrowser:this.props.context.mobileBrowser,renderSFPAd:this.props.renderSFPAd,adTargetingHash:this.props.adTargetingHash,slotName:this.props.slotName,locationServerData:this.props.trailServerData,serverTotalItems:100,listMethods:this.props.listMethods}))}},{key:"staticMapAltText",value:function(){return"".concat(this.props.trail.name," ").concat(H.b.strings.MAP)}},{key:"renderTrailAdSlot",value:function(){return this.props.context&&this.props.context.proUser?null:a.a.createElement("section",{id:"aside-ad"},a.a.createElement("div",{id:"div-gpt-ad-alltrails_trail_300x250"}))}},{key:"renderMobileMapSection",value:function(){if(this.props.exploreFlag||!this.props.context.mobileBrowser)return null;var e=null;return this.props.showAds&&(e=a.a.createElement(at.a,{renderSFPAd:this.props.renderSFPAd,adTargetingHash:this.props.adTargetingHash,slotName:this.props.slotName})),a.a.createElement("div",{id:"mobile-trail-map"},a.a.createElement("div",{id:"map"},a.a.createElement(pn,{trail:this.props.trail,href:this.props.exactExplorePath,staticMapUrl:this.props.staticMapUrl,currentUser:this.props.context.currentUser,lat:this.props.trail._geoloc.lat,lng:this.props.trail._geoloc.lng,languageRegionCode:this.props.context.languageRegionCode,atRef:"sidebar-view-full-map",event:"trail_explore",mobileBrowser:this.props.context.mobileBrowser})),e)}},{key:"renderStaticMapSidebar",value:function(){return a.a.createElement("div",{className:"mapContainer"},a.a.createElement("div",{id:"map"},a.a.createElement(pn,{trail:this.props.trail,href:this.props.exactExplorePath,staticMapUrl:this.props.staticMapUrl,currentUser:this.props.context.currentUser,lat:this.props.trail._geoloc.lat,lng:this.props.trail._geoloc.lng,languageRegionCode:this.props.context.languageRegionCode,atRef:"sidebar-view-full-map",event:"trail_explore",mobileBrowser:this.props.context.mobileBrowser})))}},{key:"render",value:function(){var e=this.props.currentUser?this.props.currentUser.id:null,t=this.props.context,n=t.proUser,r=t.adminUser;return a.a.createElement(It.b,{context:this.props.context},a.a.createElement("div",{id:"main",className:"design-variant-1 xlate-none",itemScope:!0,itemType:"http://schema.org/LocalBusiness",itemID:"/".concat(this.props.trail.slug)},this.renderRobotsTag(),a.a.createElement("div",{className:"row"},a.a.createElement("div",{className:"col-sm-12 col-md-12"},a.a.createElement("div",{id:"main-photo"},a.a.createElement("div",{id:"title-and-menu-box",className:"relative"},a.a.createElement(k,{context:this.props.context,messagingChannel:this.props.messagingChannel,exploreFlag:this.props.exploreFlag,isPending:this.props.pending,numPhotos:this.props.numPhotos,photoUrl:this.props.photoUrl,trail:this.props.trail,photos:this.props.photos,listMethods:this.props.listMethods}),a.a.createElement(zt,{exploreFlag:this.props.exploreFlag,shareObject:this.props.shareObject,context:this.props.context,trail:this.props.trail,photos:this.props.photos,numPhotos:this.props.numPhotos,currentUser:this.props.currentUser,pending:this.props.pending}))))),a.a.createElement("div",{className:"row trail-info"},a.a.createElement(Ve.a.Provider,{value:{proUser:n,adminUser:r,optimizelySettings:this.props.exploreFlag?null:this.props.optimizelySettings,trackingAttributes:this.props.optimizelyAttributeData,scrollY:this.state.scrollY}},a.a.createElement("div",{className:"col-md-8 col-sm-12"},a.a.createElement("article",null,this.renderTrailOverview(),a.a.createElement(hn,{displayMetric:this.props.context.displayMetric,trail:this.props.trail,routeType:this.props.routeType,languageRegionCode:this.props.context.languageRegionCode}),this.renderTagCloud(),this.renderMobileMapSection(),a.a.createElement(Ne,{context:this.props.context,trailId:this.props.trail.trail_id,tabs:this.props.overviewProps.tabs,exploreFlag:this.props.exploreFlag}),a.a.createElement(ke.a,{latitude:this.props.trail._geoloc.lat,longitude:this.props.trail._geoloc.lng,weatherForecast:this.props.weatherConditionsProps.weatherForecast,metric:this.props.context.displayMetric,locale:this.props.context.languageRegionCode,tabs:this.props.weatherConditionsProps.tabs}),a.a.createElement("section",{id:"activity-feeds"},a.a.createElement(M.a,{trailUrl:"/".concat(this.props.trail.slug),trailId:this.props.trail.trail_id,trailName:this.props.trail.name,reviews:this.props.reviews,photos:this.props.photos,completed:this.props.completedJson,itemTotals:this.props.itemTotals,locationServerData:this.props.locationServerData,ratingsBreakdown:this.props.ratingsBreakdown,tracks:this.props.tracks,loggedInUser:!!this.props.currentUser,userId:e,adminUser:this.props.context.adminUser,adminOrPendingOwner:this.props.adminOrPendingOwner,exploreFlag:this.props.exploreFlag,modalSigninPath:"/signup",section:"trail-show",currentUserId:e,currentUser:this.props.currentUser,locale:this.props.context.languageRegionCode,popTrailReview:this.props.popTrailReview,mobileBrowser:this.props.context.mobileBrowser,messagingChannel:this.props.messagingChannel,context:this.props.context})))),this.renderTrailSidebar()))))}}])&&vn(t.prototype,n),r&&vn(t,r),s}(r.Component);t.a=Sn}}]);
//# sourceMappingURL=17-6e085b0f95348e4bde0c.chunk.js.map