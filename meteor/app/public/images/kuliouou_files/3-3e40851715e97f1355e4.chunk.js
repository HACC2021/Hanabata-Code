(this.webpackJsonp=this.webpackJsonp||[]).push([[3],{332:function(t,e,a){"use strict";a.d(e,"a",(function(){return l}));var r=a(0),s=a.n(r),n=a(28),i=0,o=["NC4hUkTKcXSBBb55vjzDHp4P","1g966Cc46p2DkoDbTquvdFS1","GaJUA37jxakA8rQU1K4xbEdP"],l=n({displayName:"AdResultCard",getInitialState:function(){var t="div-gpt-ad-1551826656348-".concat(i+=1),e="Q1tHrwHQjqvjUg8PYTSLXMyj";return i<=3&&(e=o[i-1]),{adUnitName:t,placementApiKey:e}},componentDidMount:function(){if(this.props.renderSFPAd){var t=[[1,1]];googletag.cmd.push(function(){var e=googletag.defineSlot(this.props.slotName,t,this.state.adUnitName).setTargeting("state",[]).setTargeting("Pro",["0","1"]).setTargeting("Member",["0","1"]).setTargeting("strnativekey",this.state.placementApiKey).addService(googletag.pubads());googletag.pubads().enableSingleRequest(),googletag.enableServices(),googletag.pubads().refresh([e]),googletag.display(this.state.adUnitName),this.setState({currentAdSlot:e})}.bind(this))}else googletag.cmd.push(function(){var t=googletag.defineSlot(this.props.slotName,this.props.adSizes,this.state.adUnitName).addService(googletag.pubads()).setCollapseEmptyDiv(!0);googletag.pubads().setTargeting("position",[i]),Object.keys(this.props.adTargetingHash).forEach(function(t){this.props.adTargetingHash[t]&&googletag.pubads().setTargeting(t,[this.props.adTargetingHash[t]])}.bind(this)),googletag.pubads().setTargeting("Member",["0","1"]),googletag.pubads().disableInitialLoad(),this.setState({currentAdSlot:t}),googletag.display(this.state.adUnitName)}.bind(this))},shouldComponentUpdate:function(t,e){return!!t.refreshAd},componentDidUpdate:function(){this.props.refreshAd},componentWillUnmount:function(){googletag.cmd.push(function(){googletag.destroySlots([this.state.currentAdSlot])}.bind(this))},render:function(){var t="ad-result-card";t+=this.props.renderSFPAd?" sfp":" dfp";var e=this.props.renderSFPAd?{width:1,height:1}:{};return s.a.createElement("div",{id:"sharethrough-unit-".concat(i),className:t},s.a.createElement("div",{id:this.state.adUnitName,style:e,className:"holder"}))}});l.defaultProps={renderSFPAd:!1,adTargetingHash:{},slotName:"/4689141/alltrails_trail_300x250_top",adSizes:["fluid",[300,250]]}},422:function(t,e,a){"use strict";a.d(e,"a",(function(){return p}));var r=a(41),s=a(4),n=a(6),i=a(2),o=a(19);function l(t){return function(t){if(Array.isArray(t))return c(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return c(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return c(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}var p={allowAddRemove:function(){return[s.PageStrings.EXPLORE_COMPLETED_PAGE,s.PageStrings.EXPLORE_FAVORITE_PAGE,s.PageStrings.EXPLORE_CUSTOM_PAGE,s.PageStrings.EXPLORE_USERS_TRACKS_PAGE,s.PageStrings.EXPLORE_USERS_MAPS_PAGE].includes(this.state.page)&&this.props.context.currentUser&&this.props.userInfo&&(this.props.context.currentUser.admin||this.props.context.currentUser.id==this.props.userInfo.id)},allowClickingCompletedBadge:function(){return this.state.page===s.PageStrings.EXPLORE_COMPLETED_PAGE&&this.props.context&&this.props.context.currentUser&&this.props.context.currentUser.admin},forcePhotoId:function(t,e){return-1===["map","track"].indexOf(t)?null:this.state.forceTrackPhotoIds?this.state.forceTrackPhotoIds[e]:this.props.initialPhotoId},getAddRemoveLabels:function(){switch(this.state.page){case s.PageStrings.EXPLORE_COMPLETED_PAGE:return{add:i.b.strings.SEARCH.ADD_TO_COMPLETED,remove:i.b.strings.SEARCH.REMOVE_FROM_COMPLETED};case s.PageStrings.EXPLORE_FAVORITE_PAGE:return{add:i.b.strings.SEARCH.ADD_TO_FAVORITES,remove:i.b.strings.SEARCH.REMOVE_FROM_FAVORITES};case s.PageStrings.EXPLORE_CUSTOM_PAGE:return{add:i.b.strings.SEARCH.ADD_TO_LIST,remove:i.b.strings.SEARCH.REMOVE_FROM_LIST};case s.PageStrings.EXPLORE_USERS_TRACKS_PAGE:case s.PageStrings.EXPLORE_USERS_MAPS_PAGE:return{add:null,remove:i.b.strings.DELETE};default:return{}}},handleAddRemoveClick:function(t,e){switch(this.state.page){case s.PageStrings.EXPLORE_COMPLETED_PAGE:case s.PageStrings.EXPLORE_FAVORITE_PAGE:case s.PageStrings.EXPLORE_CUSTOM_PAGE:return this.props.listMethods.toggleListItem(this.props.listId,t,e);case s.PageStrings.EXPLORE_USERS_TRACKS_PAGE:case s.PageStrings.EXPLORE_USERS_MAPS_PAGE:return this.handleDeleteMapClick(t,e);default:return null}},handleDeleteMapClick:function(t,e){var a=this;if(confirm(i.b.strings.DELETE_ITEM_QUESTION)){var r="/api/alltrails/maps/".concat(e);n.a.deleteApiEndpoint(r,{},(function(t){var r=a.state.results.filter((function(t){return t.ID!=e}));a.setState({results:r})}),(function(){}),(function(){}))}},handleCompletedBadgeClick:function(t,e){var a;this.props.context.currentUser.admin&&(a=this.state.page===s.PageStrings.EXPLORE_COMPLETED_PAGE&&this.props.context.currentUser&&this.props.context.currentUser.admin&&this.props.userInfo&&this.props.context.currentUser.id!=this.props.userInfo.id?this.props.userInfo.id:null,this.props.listMethods.toggleListItem(r.VERIFIED_MAGIC_ID,t,e,a))},isItemInPageList:function(t,e){switch(this.state.page){case s.PageStrings.EXPLORE_FAVORITE_PAGE:return this.props.listMethods.isFavorite(t,e);case s.PageStrings.EXPLORE_USERS_TRACKS_PAGE:case s.PageStrings.EXPLORE_USERS_MAPS_PAGE:return!0;default:return this.props.listMethods.isItemInList(t,e,this.props.listId)}},updateResultsFromListHash:function(t,e){var a=t.action,s=t.listItem,n=this.props.listId,i=l(this.state.results);i&&parseInt(s.listId)===parseInt(n)&&(i=i.filter((function(t){return t.objectID!=="".concat(s.type,"-").concat(s.objectId)})),"add"===a&&s.object&&i.unshift(s.object));var c=this.state.filters;if(c){var p=Object.keys(Object(r.itemsInListOfType)(n,"trail",e));o.a.setFilter(c,"trailIds",p);var d=Object.keys(Object(r.itemsInListOfType)(n,"track",e));o.a.setFilter(c,"trackIds",d);var h=Object.keys(Object(r.itemsInListOfType)(n,"map",e));o.a.setFilter(c,"mapIds",h)}if(i||c){var u=this.performSearch?this.performSearch:function(){};this.setState({filters:c,results:i},u)}},getResultCardFunctions:function(){return{forcePhotoId:this.forcePhotoId,allowClickingCompletedBadge:this.allowClickingCompletedBadge,allowAddRemove:this.allowAddRemove,getAddRemoveLabels:this.getAddRemoveLabels,isItemInPageList:this.isItemInPageList,handleAddRemoveClick:this.handleAddRemoveClick,handleMapClick:this.handleMapClick,handleTrackClick:this.handleTrackClick,handleTrailClick:this.handleTrailClick,formatTrailUrl:this.formatTrailUrl,handleCompletedBadgeClick:this.handleCompletedBadgeClick,handleFavoriteClick:this.handleFavoriteClick,handleLocationClick:this.handleTrailLocationClick}}}},423:function(t,e,a){"use strict";a.d(e,"a",(function(){return o}));var r=a(0),s=a.n(r),n=a(271),i=a(2);function o(t){var e=t.mapType,a=t.className;if(!e)return null;var r="map"===e?i.b.strings.MAP:i.b.strings.RECORDING;return s.a.createElement(n.a,{title:r,className:a},r)}},424:function(t,e,a){"use strict";a.d(e,"a",(function(){return g}));var r=a(0),s=a.n(r),n=a(24),i=a.n(n),o=a(75),l=a(270),c=a(273),p=a(139),d=a(68),h=a(274),u=a(178);function g(t){var e=t.className,a=t.userImageClassNameOverride,r=t.context,n=t.track,g=t.namePaddingRight;return s.a.createElement("div",{className:[i.a.content,e].join(" ")},s.a.createElement(p.a,{name:n.name,paddingRight:g}),s.a.createElement("div",{className:i.a.info},s.a.createElement(l.a,{dateString:n.created_at,timezone:n.timezone,locale:r?r.languageRegionCode:"en-US"})),s.a.createElement("div",{className:i.a.metadataContent},s.a.createElement(u.a,{className:a||i.a.inlineBlock,context:r,user:n.user}),s.a.createElement("div",{className:"".concat(i.a.inlineBlock," ").concat(i.a.marginTop)},s.a.createElement("div",{className:i.a.info},s.a.createElement(h.a,{className:i.a.activityTag,title:Object(o.b)(n)}),s.a.createElement(d.a,{config:n.rating})),s.a.createElement("div",{className:i.a.info},s.a.createElement(c.a,{length:n.length||n.distance,displayMetric:r?r.displayMetric:null,languageRegionCode:r.languageRegionCode})))))}},452:function(t,e,a){"use strict";a.d(e,"a",(function(){return T}));var r=a(0),s=a.n(r),n=a(1),i=a.n(n),o=a(44),l=a.n(o),c=a(323),p=a(111),d=a(324),h=a(96),u=a(272),g=a(174),m=a(423),f=a(424),v=a(75),E=a(6),b=a(217);function C(t){return(C="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t){return function(t){if(Array.isArray(t))return S(t)}(t)||function(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(!t)return;if("string"===typeof t)return S(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);"Object"===a&&t.constructor&&(a=t.constructor.name);if("Map"===a||"Set"===a)return Array.from(t);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return S(t,e)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=new Array(e);a<e;a++)r[a]=t[a];return r}function P(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function I(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=A(t);if(e){var s=A(this).constructor;a=Reflect.construct(r,arguments,s)}else a=r.apply(this,arguments);return R(this,a)}}function R(t,e){return!e||"object"!==C(e)&&"function"!==typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function A(t){return(A=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var O=function(t){!function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}(i,t);var e,a,r,n=I(i);function i(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,i),(e=n.call(this,t)).handleMouseEnter=function(){e.state.preloaded||e.preloadPhotos(),e.props.messagingChannel&&e.props.messagingChannel.publish("item.mouseenter",e.props.track)},e.handleMouseLeave=function(){e.props.messagingChannel&&e.props.messagingChannel.publish("item.mouseleave",e.props.track)},e.handleBeforeImageChange=function(){e.state.preloaded||e.preloadPhotos()},e.handleCardClick=function(t){if(e.props.ignoreClicks)return!1;if(E.a.handleGaqPush(["_trackEvent","Search Page","Result List","Position ".concat(e.props.idx," Track Clicked")]),E.a.handleGaqPush.bind(null,["_trackEvent","Search Page","Hovercard","Track Click"]),e.props.handleCardClick)e.props.handleCardClick();else{var a=Object(v.a)(e.props.track,e.props.context).localizedUrl;window.location=a}return!1},e.state={photoUrls:e.getInitPhotoUrls(t.track),preloaded:!1},e}return e=i,(a=[{key:"shouldComponentUpdate",value:function(t,e){return Object(b.a)(this,t,e,(function(t){return!t.includes("Click")}))}},{key:"getInitPhotoUrls",value:function(t){var e=t.photo_count||0;if(e>this.props.maxInitPhotos&&(e=this.props.maxInitPhotos),0===e)return[Object(v.e)(t)];for(var a=[Object(v.e)(t),Object(v.d)(t,"large",!1)],r=2;r<e;r++)a.push(null);return a}},{key:"preloadPhotos",value:function(){var t=this;this.props.track.photo_count&&Object(v.c)(this.props.track,this.props.maxPhotos,"large").then((function(e){var a=t.state.photoUrls;e=e.slice(1),a=[a[0],a[1]].concat(y(e)),e.forEach((function(t){(new Image).src=t})),t.setState({preloaded:!0,photoUrls:a})})).catch((function(t){console.error("<TrackResultCard />, getTrackPhotoUrls",t)}))}},{key:"renderTopLeftButton",value:function(){return this.props.allowItemMoving?s.a.createElement(d.a,{className:l.a.topLeftButton,dragHandleProps:this.props.dragHandleProps}):s.a.createElement(m.a,{className:l.a.badge,mapType:this.props.track.type})}},{key:"renderTopRightButton",value:function(){return this.props.allowItemDelete&&this.props.handleItemDeleteClick?s.a.createElement(c.a,{className:l.a.topRightButton,handleClick:this.props.handleItemDeleteClick,isInCollection:!0,removeLabel:this.props.itemDeleteLabel}):this.props.showFavoriteHeart&&this.props.handleFavoriteClick?s.a.createElement(p.a,{className:l.a.topRightButton,handleFavoriteClick:this.props.handleFavoriteClick,isFavorite:this.props.isFavorite}):null}},{key:"renderCardImage",value:function(){var t=this.props,e=t.opaqueOverlay,a=t.track,r=this.state.photoUrls;return r?r.length>1&&!e?s.a.createElement(u.a,{className:"".concat(l.a.imageCarousel," ").concat(this.props.imageCarouselClassName),classNameImage:"".concat(l.a.image," ").concat(this.props.imageCarouselClassName),handleBeforeChange:this.handleBeforeImageChange,handleCardClick:this.handleCardClick,lowerButtons:!this.props.descriptive,photoUrls:r,title:a.name,slickSettings:{initialSlide:1}}):s.a.createElement(h.a,{className:"".concat(l.a.image," ").concat(this.props.imageCarouselClassName," ").concat(l.a.imagePositionUnset),lazyload:!0,url:r[0],title:a.name,darker:e}):null}},{key:"render",value:function(){var t=Object(v.a)(this.props.track,this.props.context).localizedUrl;return s.a.createElement("div",{className:"".concat(l.a.container," ").concat(this.props.className),onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave},s.a.createElement(g.a,{url:t,title:this.props.track.name,handleClick:this.handleCardClick}),s.a.createElement("a",{href:t},this.renderCardImage()),s.a.createElement(f.a,{bottomButtonsConfig:this.props.bottomButtonsConfig,className:l.a.content,context:this.props.context,track:this.props.track}),this.renderTopLeftButton(),this.renderTopRightButton())}}])&&P(e.prototype,a),r&&P(e,r),i}(s.a.Component);O.propTypes={imageCarouselClassName:i.a.string,className:i.a.string},O.defaultProps={maxInitPhotos:5,maxPhotos:6,imageCarouselClassName:"",className:""};var T=O},746:function(t,e,a){"use strict";var r=a(43),s=a.n(r),n=a(0),i=a.n(n),o=a(41),l=a(124),c=a(360),p=a(332),d=a(422),h=a(6),u=a(452),g=a(164),m=a(2),f=a(25),v=a(40),E=a(242);function b(){return(b=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var a=arguments[e];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(t[r]=a[r])}return t}).apply(this,arguments)}var C=a(28)({displayName:"SidebarTrailResultList",mixins:[d.a],getInitialState:function(){var t=[];return this.props.results.forEach((function(e){var a;(a=e.model?e.model.trail:e).ID||(a.type="trail",a.ID=a.trail_id,a.num_reviews=a.times_reviewed),t.push(a)})),{inOrNearLoc:"city"===this.props.locationType?"near":"in",noResultsObj:null,results:t,isMobileWidth:!1,tabletBrowser:!1,visibleItems:24,perPage:24,page:1,serverTotalItems:this.props.serverTotalItems,saveToList:null}},componentDidMount:function(){this.messagingChannel=s.a.channel("explore_messagingChannel")},componentDidUpdate:function(t,e){this.props.listId&&t.latestListAction!==this.props.latestListAction&&this.props.belongsToCurrentUser&&this.updateResultsFromListHash(this.props.latestListAction,this.props.userListItems)},saveListOrder:function(){var t=this;this.listSaveOrderRequest&&(this.listSaveOrderRequest.abort(),this.listSaveOrderRequest=null);var e=this.state.results.map((function(e){var a;return null===(a=t.props.listMethods.getListItemInList(t.props.listId,e.type,e.ID,t.props.userListItems))||void 0===a?void 0:a.id})),a=null;this.state.results.length<this.state.serverTotalItems&&(a=[this.state.serverTotalItems+1-this.state.page*this.state.perPage,this.state.serverTotalItems]),this.listSaveOrderRequest=$.ajax({type:"PUT",headers:{"X-AT-KEY":h.a.apiKey},url:"/api/alltrails/v2/lists/".concat(this.props.listId,"/reorder"),dataType:"json",data:{ordered_list_item_ids:e,item_range:a},success:function(e){t.listSaveOrderRequest=null,e.profile_photo_url&&$("#list-profile-photo").css({"background-image":'linear-gradient(rgba(0, 0, 0, 0.0), rgba(0, 0, 0, 0.6)), url("'.concat(e.profile_photo_url,'")'),"background-repeat":"no-repeat","background-position":"center center"})},error:function(t){Object(v.a)(t)}})},onDragEnd:function(t){if(t.destination){var e=Object(o.reorder)(this.state.results,t.source.index,t.destination.index);this.setState({results:e},this.saveListOrder)}},handleTrailClick:function(t){var e=Object(f.c)(t,this.props.context).localizedUrl;window.location=e},handleTrackClick:function(t){window.location=window.checkLinkAndAppendLanguage("/explore/recording/".concat(t.slug))},handleMapClick:function(t){window.location=window.checkLinkAndAppendLanguage("/explore/map/".concat(t.slug))},handleLocationClick:function(t,e){window.location=Object(E.a)(t,e,this.props.context.languageRegionCode)},renderResult:function(t,e){var a=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return"trail"===t.type?i.a.createElement(g.a,{allowItemMoving:this.props.allowReordering,context:this.props.context,displayRank:this.props.displayRank?e+1:null,handleCardClick:function(){return a.handleTrailClick(t)},handleFavoriteClick:function(){return a.props.listMethods.handleFavoriteClick(t.type,t.ID)},handleLocationClick:this.handleLocationClick,idx:e,isCompleted:this.props.listMethods.isComplete(t.type,t.ID),isFavorite:this.props.listMethods.isFavorite(t.type,t.ID),isMobileWidth:this.props.isMobileWidth,isVerified:this.props.listMethods.isVerified(t.type,t.ID),key:"trail-".concat(t.ID),messagingChannel:this.messagingChannel,showFavoriteHeart:!0,tabletBrowser:this.props.tabletBrowser,trail:t,dragHandleProps:r}):"track"===t.type||"map"===t.type?i.a.createElement(u.a,{allowItemMoving:this.props.allowReordering,context:this.props.context,forcePhotoId:this.forcePhotoId(t.type,t.ID),handleCardClick:function(){return("track"==t.type?a.handleTrackClick:a.handleMapClick)(t)},handleFavoriteClick:function(){return a.props.listMethods.handleFavoriteClick(t.type,t.ID)},idx:e,isFavorite:this.props.listMethods.isFavorite(t.type,t.ID),isMobileWidth:this.props.isMobileWidth,key:"track-".concat(t.ID),messagingChannel:this.messagingChannel,showFavoriteHeart:!0,tabletBrowser:this.props.context.tabletBrowser,track:t,dragHandleProps:r}):null},renderSortableListItems:function(){var t,e=this;return this.state.results&&0!==this.state.results.length?i.a.createElement(c.a,null,i.a.createElement(l.a,{onDragEnd:this.onDragEnd},i.a.createElement(l.c,{droppableId:"droppable"},(function(a){return i.a.createElement("ul",b({},a.droppableProps,{ref:a.innerRef}),e.state.results.map((function(a,r){return t=a.ID.toString(),i.a.createElement(l.b,{key:t,draggableId:t,index:r},(function(t){return i.a.createElement("li",b({ref:t.innerRef},t.draggableProps),e.renderResult(a,r,t.dragHandleProps))}))})),a.placeholder)})))):null},renderListItems:function(){var t=this,e=null;if(this.props.allowReordering)return this.renderSortableListItems();if(this.state.results&&this.state.results.length>0)if((e=this.state.results.map((function(e,a){return a>=t.state.visibleItems?null:"trail"==e.type?i.a.createElement(g.a,{allowItemMoving:t.props.allowReordering,context:t.props.context,displayRank:t.props.displayRank?a+1:null,handleCardClick:function(){return t.handleTrailClick(e)},handleFavoriteClick:function(){return t.props.listMethods.handleFavoriteClick(e.type,e.ID)},handleLocationClick:t.handleLocationClick,idx:a,isCompleted:t.props.listMethods.isComplete(e.type,e.ID),isFavorite:t.props.listMethods.isFavorite(e.type,e.ID),isMobileWidth:t.props.isMobileWidth,isVerified:t.props.listMethods.isVerified(e.type,e.ID),key:"trail-".concat(e.ID),messagingChannel:t.messagingChannel,showFavoriteHeart:!0,tabletBrowser:t.props.tabletBrowser,trail:e}):"track"==e.type||"map"==e.type?i.a.createElement(u.a,{allowItemMoving:t.props.allowReordering,context:t.props.context,forcePhotoId:t.forcePhotoId(e.type,e.ID),handleCardClick:function(){return("track"==e.type?t.handleTrackClick:t.handleMapClick)(e)},handleFavoriteClick:function(){return t.props.listMethods.handleFavoriteClick(e.type,e.ID)},idx:a,isFavorite:t.props.listMethods.isFavorite(e.type,e.ID),isMobileWidth:t.props.isMobileWidth,key:"track-".concat(e.ID),messagingChannel:t.messagingChannel,showFavoriteHeart:!0,tabletBrowser:t.props.context.tabletBrowser,track:e}):null}))).length>5&&this.props.showAds)for(var a=e.length,r=0,s=4;s<a;s+=5)e.splice(s+r,0,i.a.createElement(p.a,{key:"ad-".concat(s),adTargetingHash:this.props.adTargetingHash,renderSFPAd:this.props.renderSFPAd,slotName:this.props.slotName})),r+=1;else this.props.showAds&&e.push(i.a.createElement(p.a,{key:"ad-1",adTargetingHash:this.props.targetingHash,renderSFPAd:this.props.renderSFPAd,slotName:this.props.slotName}));else e=null;return Array.isArray(e)&&(e=e.filter((function(t){return void 0!==t&&null!==t})).map((function(t,e){return i.a.createElement("li",{className:void 0!==t.props.idx?"sortable":"","data-id":t.props.idx,key:"result-item".concat(e)},t)}))),i.a.createElement("ul",null,e)},addNextPage:function(t){t.preventDefault(),t.stopPropagation();var e=this.state.page+1;return this.addMoreTrails(e),this.setState({loading:!0}),!1},addMoreTrails:function(t){var e=this;"lists"===this.props.locationServerData.type?(h.a.loadMoreContent("items",this.props.locationServerData.country_id,this.props.locationServerData.type,this.props.locationServerData.list_id,t,this.state.perPage,!1,this.props.locationServerData.attribute,(function(a){var r=a.listItems.map((function(t){return t.object}));e.setState({results:e.state.results.concat(r),page:t,visibleItems:e.state.visibleItems+r.length,loading:!1})}),!1,null,null,this.props.locale),this.setState({loading:!1})):"trails"===this.props.locationServerData.type?(h.a.loadMoreContent("nearby_trails",null,this.props.locationServerData.type,this.props.locationServerData.trailId,t,this.state.perPage,!1,null,function(e){var a=this.state.serverTotalItems;e.trails.length<this.state.perPage&&(a=this.state.visibleItems+e.trails.length),this.setState({results:this.state.results.concat(e.trails),page:t,visibleItems:this.state.visibleItems+e.trails.length,serverTotalItems:a,loading:!1})}.bind(this),!1,null,null,this.props.locale),this.setState({loading:!1})):h.a.loadMoreContent("trails",this.props.locationServerData.country_id,this.props.locationServerData.type,this.props.locationServerData.loc_id,t,this.state.perPage,!1,this.props.locationServerData.attribute,function(e){this.setState({results:this.state.results.concat(e.trails),page:t,visibleItems:this.state.visibleItems+e.trails.length,loading:!1})}.bind(this),!1,null,null,this.props.locale)},loadMoreText:function(){return 1==this.state.loading?i.a.createElement("h3",{className:"loading trail-loading"},m.b.strings.SEARCH.LOADING):i.a.createElement("h3",null,m.b.strings.SEARCH.SHOW_MORE_TRAILS)},getPagingButton:function(){return this.state.visibleItems<this.state.serverTotalItems?i.a.createElement("div",{id:"load_more"},i.a.createElement("a",{onClick:this.addNextPage},i.a.createElement("div",{className:"show-more-trails"},this.loadMoreText()))):""},render:function(){var t="non-scrolling-trail-list";return this.props.nearLocation||(t+=" near-location"),i.a.createElement("div",{className:t},i.a.createElement("div",{className:"result-info"},this.props.h1Obj,i.a.createElement("div",null,null)),this.renderListItems(),this.getPagingButton())}});C.defaultProps={resultCountString:"None",showAds:!0,containsPlaceFlag:!1,displayRank:!1},e.a=C}}]);
//# sourceMappingURL=3-3e40851715e97f1355e4.chunk.js.map